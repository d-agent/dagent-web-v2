"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[257],{77669:function(e,t,r){let i;r.d(t,{$Od:function(){return rE},$xJ:function(){return ri},BI7:function(){return rk},BRr:function(){return rJ},BSq:function(){return re},DLH:function(){return tG},EZS:function(){return t7},HKJ:function(){return rH},HcE:function(){return rK},I1w:function(){return t9},Jth:function(){return rm},LVF:function(){return r$},QXY:function(){return e2},TES:function(){return rV},XfO:function(){return tW},Xji:function(){return rL},YW8:function(){return tP},Yf_:function(){return rz},_Ap:function(){return rq},_Kn:function(){return tX},_f2:function(){return it},brL:function(){return ip},c8Z:function(){return rA},d3g:function(){return t3},fIT:function(){return rD},iOb:function(){return t1},jms:function(){return rX},kLt:function(){return tZ},kPi:function(){return rj},oHj:function(){return rP},ri7:function(){return rC},sZt:function(){return rg},w1h:function(){return e3},ye4:function(){return rW},yq6:function(){return o},zop:function(){return rM}});var o=r(56295),n=r(72117),s=r(48117),a=r(21967),u=r(16058),c=r(66780),l=r(82500),h=r(87205),d=r(73492),p=r(12837),f=r(1208),m=r(77697),g=r(72813),y=r(89446),w=r(46001),v=r(20528),b=r(32991),S=r(43722),x=r(52991),C=r(47873),I=r(20475),A=r(85968),P=r(17214),B=r(14325),E=r(93263),k=r(70034),V=r(45180),N=r(58261),H=r(42082),R=r(28946),_=r(61004),T=r(31889),O=r(8822),z=r(80162),D=r(92660),M=r(21546),j=r(30641),K=r(31561),U=r(590),W=r(84231),L=r(59853),q=r(32640),F=r(91165),Z=r(74064),$=r(93028),G=r(33811),J=r(41336),Y=r(74719),X=r(88020),Q=r(21e3),ee=r(81585),et=r(56364),er=r(41875),ei=r(22807),eo=r(32549),en=r(73274),es=r(62157),ea=r(62611),eu=r(91870),ec=r(45204),el=r(47455),eh=r(15865),ed=r(24378),ep=r(5384),ef=r(13017),em=r(69649),eg=r(29523),ey=r(82957),ew=r(20886),ev=r(84041),eb=r(68989),eS=r(49358),ex=r(46294),eC=r(49686),eI=r(8623),eA=r(47970),eP=r(72823),eB=r(68743),eE=r(65560),ek=r(97284),eV=r(66441),eN=r(23597),eH=r(66424),eR=r(6509),e_=r(70570),eT=r(56111),eO=r(41380),ez=r(53345),eD=r(29615),eM=r(10771),ej=r(11486),eK=r(45136),eU=r(55356),eW=r(67270),eL=r(59499),eq=r(30685),eF=r(52381),eZ=r(59142),e$=r(48044),eG=r(24491),eJ=r(66929),eY=r(19179),eX=r(29119),eQ=r(54833),e0=r(95364),e1=r(94562);r(89808),r(2335);var e2=r(15226),e3=r(3207),e4=r(82957).Buffer,e5=Object.create,e9=Object.defineProperty,e6=Object.getOwnPropertyDescriptor,e7=Object.getOwnPropertyNames,e8=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty,tt=(i=function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(i,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):i),tr=(e,t)=>function(){return t||(0,e[e7(e)[0]])((t={exports:{}}).exports,t),t.exports},ti=(e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of e7(t))te.call(e,o)||o===r||e9(e,o,{get:()=>t[o],enumerable:!(i=e6(t,o))||i.enumerable});return e},to=(e,t,r)=>(r=null!=e?e5(e8(e)):{},ti(!t&&e&&e.__esModule?r:e9(r,"default",{value:e,enumerable:!0}),e)),tn=tr({"../../node_modules/bignumber.js/bignumber.js"(e,t){!function(e){var r,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,n=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function c(e){var t=0|e;return e>0||e===t?t:t-1}function l(e){for(var t,r,i=1,o=e.length,n=e[0]+"";i<o;){for(r=14-(t=e[i++]+"").length;r--;t="0"+t);n+=t}for(o=n.length;48===n.charCodeAt(--o););return n.slice(0,o+1||1)}function h(e,t){var r,i,o=e.c,n=t.c,s=e.s,a=t.s,u=e.e,c=t.e;if(!s||!a)return null;if(r=o&&!o[0],i=n&&!n[0],r||i)return r?i?0:-a:s;if(s!=a)return s;if(r=s<0,i=u==c,!o||!n)return i?0:!o^r?1:-1;if(!i)return u>c^r?1:-1;for(s=0,a=(u=o.length)<(c=n.length)?u:c;s<a;s++)if(o[s]!=n[s])return o[s]>n[s]^r?1:-1;return u==c?0:u>c^r?1:-1}function d(e,t,r,i){if(e<t||e>r||e!==n(e))throw Error(s+(i||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function p(e){var t=e.c.length-1;return c(e.e/14)==t&&e.c[t]%2!=0}function f(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function m(e,t,r){var i,o;if(t<0){for(o=r+".";++t;o+=r);e=o+e}else if(i=e.length,++t>i){for(o=r,t-=i;--t;o+=r);e+=o}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}(r=function e(t){var r,g,y,w,v,b,S,x,C,I=D.prototype={constructor:D,toString:null,valueOf:null},A=new D(1),P=20,B=4,E=-7,k=21,V=-1e7,N=1e7,H=!1,R=1,_=0,T={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},O="0123456789abcdefghijklmnopqrstuvwxyz",z=!0;function D(e,t){var r,o,s,u,c,l,h,p,f=this;if(!(f instanceof D))return new D(e,t);if(null==t){if(e&&!0===e._isBigNumber){f.s=e.s,!e.c||e.e>N?f.c=f.e=null:e.e<V?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice());return}if((l="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,c=e;c>=10;c/=10,u++);u>N?f.c=f.e=null:(f.e=u,f.c=[e]);return}p=String(e)}else{if(!i.test(p=String(e)))return C(f,p,l);f.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(u=p.indexOf("."))>-1&&(p=p.replace(".","")),(c=p.search(/e/i))>0?(u<0&&(u=c),u+=+p.slice(c+1),p=p.substring(0,c)):u<0&&(u=p.length)}else{if(d(t,2,O.length,"Base"),10==t&&z)return U(f=new D(e),P+f.e+1,B);if(p=String(e),l="number"==typeof e){if(0*e!=0)return C(f,p,l,t);if(f.s=1/e<0?(p=p.slice(1),-1):1,D.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else f.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=O.slice(0,t),u=c=0,h=p.length;c<h;c++)if(0>r.indexOf(o=p.charAt(c))){if("."==o){if(c>u){u=h;continue}}else if(!s&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){s=!0,c=-1,u=0;continue}return C(f,String(e),l,t)}l=!1,(u=(p=x(p,t,10,f.s)).indexOf("."))>-1?p=p.replace(".",""):u=p.length}for(c=0;48===p.charCodeAt(c);c++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(c,++h)){if(h-=c,l&&D.DEBUG&&h>15&&(e>9007199254740991||e!==n(e)))throw Error(a+f.s*e);if((u=u-c-1)>N)f.c=f.e=null;else if(u<V)f.c=[f.e=0];else{if(f.e=u,f.c=[],c=(u+1)%14,u<0&&(c+=14),c<h){for(c&&f.c.push(+p.slice(0,c)),h-=14;c<h;)f.c.push(+p.slice(c,c+=14));c=14-(p=p.slice(c)).length}else c-=h;for(;c--;p+="0");f.c.push(+p)}}else f.c=[f.e=0]}function M(e,t,r,i){var o,n,s,a,u;if(null==r?r=B:d(r,0,8),!e.c)return e.toString();if(o=e.c[0],s=e.e,null==t)u=l(e.c),u=1==i||2==i&&(s<=E||s>=k)?f(u,s):m(u,s,"0");else if(n=(e=U(new D(e),t,r)).e,a=(u=l(e.c)).length,1==i||2==i&&(t<=n||n<=E)){for(;a<t;u+="0",a++);u=f(u,n)}else if(t-=s+(2===i&&n>s),u=m(u,n,"0"),n+1>a){if(--t>0)for(u+=".";t--;u+="0");}else if((t+=n-a)>0)for(n+1==a&&(u+=".");t--;u+="0");return e.s<0&&o?"-"+u:u}function j(e,t){for(var r,i,o=1,n=new D(e[0]);o<e.length;o++)(i=new D(e[o])).s&&(r=h(n,i))!==t&&(0!==r||n.s!==t)||(n=i);return n}function K(e,t,r){for(var i=1,o=t.length;!t[--o];t.pop());for(o=t[0];o>=10;o/=10,i++);return(r=i+14*r-1)>N?e.c=e.e=null:r<V?e.c=[e.e=0]:(e.e=r,e.c=t),e}function U(e,t,r,i){var s,a,c,l,h,d,p,f=e.c;if(f){e:{for(s=1,l=f[0];l>=10;l/=10,s++);if((a=t-s)<0)a+=14,c=t,p=n((h=f[d=0])/u[s-c-1]%10);else if((d=o((a+1)/14))>=f.length){if(i){for(;f.length<=d;f.push(0));h=p=0,s=1,a%=14,c=a-14+1}else break e}else{for(s=1,h=l=f[d];l>=10;l/=10,s++);a%=14,p=(c=a-14+s)<0?0:n(h/u[s-c-1]%10)}if(i=i||t<0||null!=f[d+1]||(c<0?h:h%u[s-c-1]),i=r<4?(p||i)&&(0==r||r==(e.s<0?3:2)):p>5||5==p&&(4==r||i||6==r&&(a>0?c>0?h/u[s-c]:0:f[d-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,i?(t-=e.e+1,f[0]=u[(14-t%14)%14],e.e=-t||0):f[0]=e.e=0,e;if(0==a?(f.length=d,l=1,d--):(f.length=d+1,l=u[14-a],f[d]=c>0?n(h/u[s-c]%u[c])*l:0),i)for(;;){if(0==d){for(a=1,c=f[0];c>=10;c/=10,a++);for(c=f[0]+=l,l=1;c>=10;c/=10,l++);a!=l&&(e.e++,1e14==f[0]&&(f[0]=1));break}if(f[d]+=l,1e14!=f[d])break;f[d--]=0,l=1}for(a=f.length;0===f[--a];f.pop());}e.e>N?e.c=e.e=null:e.e<V&&(e.c=[e.e=0])}return e}function W(e){var t,r=e.e;return null===r?e.toString():(t=l(e.c),t=r<=E||r>=k?f(t,r):m(t,r,"0"),e.s<0?"-"+t:t)}return D.clone=e,D.ROUND_UP=0,D.ROUND_DOWN=1,D.ROUND_CEIL=2,D.ROUND_FLOOR=3,D.ROUND_HALF_UP=4,D.ROUND_HALF_DOWN=5,D.ROUND_HALF_EVEN=6,D.ROUND_HALF_CEIL=7,D.ROUND_HALF_FLOOR=8,D.EUCLID=9,D.config=D.set=function(e){var t,r;if(null!=e){if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(d(r=e[t],0,1e9,t),P=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(d(r=e[t],0,8,t),B=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(d(r[0],-1e9,0,t),d(r[1],0,1e9,t),E=r[0],k=r[1]):(d(r,-1e9,1e9,t),E=-(k=r<0?-r:r))),e.hasOwnProperty(t="RANGE")){if((r=e[t])&&r.pop)d(r[0],-1e9,-1,t),d(r[1],1,1e9,t),V=r[0],N=r[1];else if(d(r,-1e9,1e9,t),r)V=-(N=r<0?-r:r);else throw Error(s+t+" cannot be zero: "+r)}if(e.hasOwnProperty(t="CRYPTO")){if(!!(r=e[t])===r){if(r){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))H=r;else throw H=!r,Error(s+"crypto unavailable")}else H=r}else throw Error(s+t+" not true or false: "+r)}if(e.hasOwnProperty(t="MODULO_MODE")&&(d(r=e[t],0,9,t),R=r),e.hasOwnProperty(t="POW_PRECISION")&&(d(r=e[t],0,1e9,t),_=r),e.hasOwnProperty(t="FORMAT")){if("object"==typeof(r=e[t]))T=r;else throw Error(s+t+" not an object: "+r)}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(s+t+" invalid: "+r);z="0123456789"==r.slice(0,10),O=r}}else throw Error(s+"Object expected: "+e)}return{DECIMAL_PLACES:P,ROUNDING_MODE:B,EXPONENTIAL_AT:[E,k],RANGE:[V,N],CRYPTO:H,MODULO_MODE:R,POW_PRECISION:_,FORMAT:T,ALPHABET:O}},D.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!D.DEBUG)return!0;var t,r,i=e.c,o=e.e,a=e.s;e:if("[object Array]"==({}).toString.call(i)){if((1===a||-1===a)&&o>=-1e9&&o<=1e9&&o===n(o)){if(0===i[0]){if(0===o&&1===i.length)return!0;break e}if((t=(o+1)%14)<1&&(t+=14),String(i[0]).length==t){for(t=0;t<i.length;t++)if((r=i[t])<0||r>=1e14||r!==n(r))break e;if(0!==r)return!0}}}else if(null===i&&null===o&&(null===a||1===a||-1===a))return!0;throw Error(s+"Invalid BigNumber: "+e)},D.maximum=D.max=function(){return j(arguments,-1)},D.minimum=D.min=function(){return j(arguments,1)},D.random=(r=9007199254740992*Math.random()&2097151?function(){return n(9007199254740992*Math.random())}:function(){return(1073741824*Math.random()|0)*8388608+(8388608*Math.random()|0)},function(e){var t,i,a,c,l,h=0,p=[],f=new D(A);if(null==e?e=P:d(e,0,1e9),c=o(e/14),H){if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(c*=2));h<c;)(l=131072*t[h]+(t[h+1]>>>11))>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),t[h]=i[0],t[h+1]=i[1]):(p.push(l%1e14),h+=2);h=c/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(c*=7);h<c;)(l=(31&t[h])*281474976710656+1099511627776*t[h+1]+4294967296*t[h+2]+16777216*t[h+3]+(t[h+4]<<16)+(t[h+5]<<8)+t[h+6])>=9e15?crypto.randomBytes(7).copy(t,h):(p.push(l%1e14),h+=7);h=c/7}else throw H=!1,Error(s+"crypto unavailable")}if(!H)for(;h<c;)(l=r())<9e15&&(p[h++]=l%1e14);for(c=p[--h],e%=14,c&&e&&(l=u[14-e],p[h]=n(c/l)*l);0===p[h];p.pop(),h--);if(h<0)p=[a=0];else{for(a=-1;0===p[0];p.splice(0,1),a-=14);for(h=1,l=p[0];l>=10;l/=10,h++);h<14&&(a-=14-h)}return f.e=a,f.c=p,f}),D.sum=function(){for(var e=1,t=arguments,r=new D(t[0]);e<t.length;)r=r.plus(t[e++]);return r},x=function(){var e="0123456789";function t(e,t,r,i){for(var o,n,s=[0],a=0,u=e.length;a<u;){for(n=s.length;n--;s[n]*=t);for(s[0]+=i.indexOf(e.charAt(a++)),o=0;o<s.length;o++)s[o]>r-1&&(null==s[o+1]&&(s[o+1]=0),s[o+1]+=s[o]/r|0,s[o]%=r)}return s.reverse()}return function(r,i,o,n,s){var a,u,c,h,d,p,f,g,y=r.indexOf("."),w=P,v=B;for(y>=0&&(h=_,_=0,r=r.replace(".",""),p=(g=new D(i)).pow(r.length-y),_=h,g.c=t(m(l(p.c),p.e,"0"),10,o,e),g.e=g.c.length),c=h=(f=t(r,i,o,s?(a=O,e):(a=e,O))).length;0==f[--h];f.pop());if(!f[0])return a.charAt(0);if(y<0?--c:(p.c=f,p.e=c,p.s=n,f=(p=S(p,g,w,v,o)).c,d=p.r,c=p.e),y=f[u=c+w+1],h=o/2,d=d||u<0||null!=f[u+1],d=v<4?(null!=y||d)&&(0==v||v==(p.s<0?3:2)):y>h||y==h&&(4==v||d||6==v&&1&f[u-1]||v==(p.s<0?8:7)),u<1||!f[0])r=d?m(a.charAt(1),-w,a.charAt(0)):a.charAt(0);else{if(f.length=u,d)for(--o;++f[--u]>o;)f[u]=0,u||(++c,f=[1].concat(f));for(h=f.length;!f[--h];);for(y=0,r="";y<=h;r+=a.charAt(f[y++]));r=m(r,c,a.charAt(0))}return r}}(),S=function(){function e(e,t,r){var i,o,n,s,a=0,u=e.length,c=t%1e7,l=t/1e7|0;for(e=e.slice();u--;)i=l*(n=e[u]%1e7)+(s=e[u]/1e7|0)*c,a=((o=c*n+i%1e7*1e7+a)/r|0)+(i/1e7|0)+l*s,e[u]=o%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,i){var o,n;if(r!=i)n=r>i?1:-1;else for(o=n=0;o<r;o++)if(e[o]!=t[o]){n=e[o]>t[o]?1:-1;break}return n}function r(e,t,r,i){for(var o=0;r--;)e[r]-=o,o=e[r]<t[r]?1:0,e[r]=o*i+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(i,o,s,a,u){var l,h,d,p,f,m,g,y,w,v,b,S,x,C,I,A,P,B=i.s==o.s?1:-1,E=i.c,k=o.c;if(!E||!E[0]||!k||!k[0])return new D(i.s&&o.s&&(E?!k||E[0]!=k[0]:k)?E&&0==E[0]||!k?0*B:B/0:NaN);for(w=(y=new D(B)).c=[],B=s+(h=i.e-o.e)+1,u||(u=1e14,h=c(i.e/14)-c(o.e/14),B=B/14|0),d=0;k[d]==(E[d]||0);d++);if(k[d]>(E[d]||0)&&h--,B<0)w.push(1),p=!0;else{for(C=E.length,A=k.length,d=0,B+=2,(f=n(u/(k[0]+1)))>1&&(k=e(k,f,u),E=e(E,f,u),A=k.length,C=E.length),x=A,b=(v=E.slice(0,A)).length;b<A;v[b++]=0);P=[0].concat(P=k.slice()),I=k[0],k[1]>=u/2&&I++;do{if(f=0,(l=t(k,v,A,b))<0){if(S=v[0],A!=b&&(S=S*u+(v[1]||0)),(f=n(S/I))>1)for(f>=u&&(f=u-1),g=(m=e(k,f,u)).length,b=v.length;1==t(m,v,g,b);)f--,r(m,A<g?P:k,g,u),g=m.length,l=1;else 0==f&&(l=f=1),g=(m=k.slice()).length;if(g<b&&(m=[0].concat(m)),r(v,m,b,u),b=v.length,-1==l)for(;1>t(k,v,A,b);)f++,r(v,A<b?P:k,b,u),b=v.length}else 0===l&&(f++,v=[0]);w[d++]=f,v[0]?v[b++]=E[x]||0:(v=[E[x]],b=1)}while((x++<C||null!=v[0])&&B--);p=null!=v[0],w[0]||w.splice(0,1)}if(1e14==u){for(d=1,B=w[0];B>=10;B/=10,d++);U(y,s+(y.e=d+14*h-1)+1,a,p)}else y.e=h,y.r=+p;return y}}(),g=/^(-?)0([xbo])(?=\w[\w.]*$)/i,y=/^([^.]+)\.$/,w=/^\.([^.]+)$/,v=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g,C=function(e,t,r,i){var o,n=r?t:t.replace(b,"");if(v.test(n))e.s=isNaN(n)?null:n<0?-1:1;else{if(!r&&(n=n.replace(g,function(e,t,r){return o="x"==(r=r.toLowerCase())?16:"b"==r?2:8,i&&i!=o?e:t}),i&&(o=i,n=n.replace(y,"$1").replace(w,"0.$1")),t!=n))return new D(n,o);if(D.DEBUG)throw Error(s+"Not a"+(i?" base "+i:"")+" number: "+t);e.s=null}e.c=e.e=null},I.absoluteValue=I.abs=function(){var e=new D(this);return e.s<0&&(e.s=1),e},I.comparedTo=function(e,t){return h(this,new D(e,t))},I.decimalPlaces=I.dp=function(e,t){var r,i,o;if(null!=e)return d(e,0,1e9),null==t?t=B:d(t,0,8),U(new D(this),e+this.e+1,t);if(!(r=this.c))return null;if(i=((o=r.length-1)-c(this.e/14))*14,o=r[o])for(;o%10==0;o/=10,i--);return i<0&&(i=0),i},I.dividedBy=I.div=function(e,t){return S(this,new D(e,t),P,B)},I.dividedToIntegerBy=I.idiv=function(e,t){return S(this,new D(e,t),0,1)},I.exponentiatedBy=I.pow=function(e,t){var r,i,a,u,c,l,h,d,f,m=this;if((e=new D(e)).c&&!e.isInteger())throw Error(s+"Exponent not an integer: "+W(e));if(null!=t&&(t=new D(t)),l=e.e>14,!m.c||!m.c[0]||1==m.c[0]&&!m.e&&1==m.c.length||!e.c||!e.c[0])return f=new D(Math.pow(+W(m),l?e.s*(2-p(e)):+W(e))),t?f.mod(t):f;if(h=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new D(NaN);(i=!h&&m.isInteger()&&t.isInteger())&&(m=m.mod(t))}else{if(e.e>9&&(m.e>0||m.e<-1||(0==m.e?m.c[0]>1||l&&m.c[1]>=24e7:m.c[0]<8e13||l&&m.c[0]<=9999975e7)))return u=m.s<0&&p(e)?-0:0,m.e>-1&&(u=1/u),new D(h?1/u:u);_&&(u=o(_/14+2))}for(l?(r=new D(.5),h&&(e.s=1),d=p(e)):d=(a=Math.abs(+W(e)))%2,f=new D(A);;){if(d){if(!(f=f.times(m)).c)break;u?f.c.length>u&&(f.c.length=u):i&&(f=f.mod(t))}if(a){if(0===(a=n(a/2)))break;d=a%2}else if(U(e=e.times(r),e.e+1,1),e.e>14)d=p(e);else{if(0==(a=+W(e)))break;d=a%2}m=m.times(m),u?m.c&&m.c.length>u&&(m.c.length=u):i&&(m=m.mod(t))}return i?f:(h&&(f=A.div(f)),t?f.mod(t):u?U(f,_,B,c):f)},I.integerValue=function(e){var t=new D(this);return null==e?e=B:d(e,0,8),U(t,t.e+1,e)},I.isEqualTo=I.eq=function(e,t){return 0===h(this,new D(e,t))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(e,t){return h(this,new D(e,t))>0},I.isGreaterThanOrEqualTo=I.gte=function(e,t){return 1===(t=h(this,new D(e,t)))||0===t},I.isInteger=function(){return!!this.c&&c(this.e/14)>this.c.length-2},I.isLessThan=I.lt=function(e,t){return 0>h(this,new D(e,t))},I.isLessThanOrEqualTo=I.lte=function(e,t){return -1===(t=h(this,new D(e,t)))||0===t},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return this.s>0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(e,t){var r,i,o,n,s=this.s;if(t=(e=new D(e,t)).s,!s||!t)return new D(NaN);if(s!=t)return e.s=-t,this.plus(e);var a=this.e/14,u=e.e/14,l=this.c,h=e.c;if(!a||!u){if(!l||!h)return l?(e.s=-t,e):new D(h?this:NaN);if(!l[0]||!h[0])return h[0]?(e.s=-t,e):new D(l[0]?this:3==B?-0:0)}if(a=c(a),u=c(u),l=l.slice(),s=a-u){for((n=s<0)?(s=-s,o=l):(u=a,o=h),o.reverse(),t=s;t--;o.push(0));o.reverse()}else for(i=(n=(s=l.length)<(t=h.length))?s:t,s=t=0;t<i;t++)if(l[t]!=h[t]){n=l[t]<h[t];break}if(n&&(o=l,l=h,h=o,e.s=-e.s),(t=(i=h.length)-(r=l.length))>0)for(;t--;l[r++]=0);for(t=1e14-1;i>s;){if(l[--i]<h[i]){for(r=i;r&&!l[--r];l[r]=t);--l[r],l[i]+=1e14}l[i]-=h[i]}for(;0==l[0];l.splice(0,1),--u);return l[0]?K(e,l,u):(e.s=3==B?-1:1,e.c=[e.e=0],e)},I.modulo=I.mod=function(e,t){var r,i;return(e=new D(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==R?(i=e.s,e.s=1,r=S(this,e,0,3),e.s=i,r.s*=i):r=S(this,e,0,R),(e=this.minus(r.times(e))).c[0]||1!=R||(e.s=this.s),e):new D(this):new D(NaN)},I.multipliedBy=I.times=function(e,t){var r,i,o,n,s,a,u,l,h,d,p,f,m,g=this.c,y=(e=new D(e,t)).c;if(!g||!y||!g[0]||!y[0])return this.s&&e.s&&(!g||g[0]||y)&&(!y||y[0]||g)?(e.s*=this.s,g&&y?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(i=c(this.e/14)+c(e.e/14),e.s*=this.s,(u=g.length)<(d=y.length)&&(m=g,g=y,y=m,o=u,u=d,d=o),o=u+d,m=[];o--;m.push(0));for(o=d;--o>=0;){for(r=0,p=y[o]%1e7,f=y[o]/1e7|0,n=o+(s=u);n>o;)a=f*(l=g[--s]%1e7)+(h=g[s]/1e7|0)*p,r=((l=p*l+a%1e7*1e7+m[n]+r)/1e14|0)+(a/1e7|0)+f*h,m[n--]=l%1e14;m[n]=r}return r?++i:m.splice(0,1),K(e,m,i)},I.negated=function(){var e=new D(this);return e.s=-e.s||null,e},I.plus=function(e,t){var r,i=this.s;if(t=(e=new D(e,t)).s,!i||!t)return new D(NaN);if(i!=t)return e.s=-t,this.minus(e);var o=this.e/14,n=e.e/14,s=this.c,a=e.c;if(!o||!n){if(!s||!a)return new D(i/0);if(!s[0]||!a[0])return a[0]?e:new D(s[0]?this:0*i)}if(o=c(o),n=c(n),s=s.slice(),i=o-n){for(i>0?(n=o,r=a):(i=-i,r=s),r.reverse();i--;r.push(0));r.reverse()}for((i=s.length)-(t=a.length)<0&&(r=a,a=s,s=r,t=i),i=0;t;)i=(s[--t]=s[t]+a[t]+i)/1e14|0,s[t]=1e14===s[t]?0:s[t]%1e14;return i&&(s=[i].concat(s),++n),K(e,s,n)},I.precision=I.sd=function(e,t){var r,i,o;if(null!=e&&!!e!==e)return d(e,1,1e9),null==t?t=B:d(t,0,8),U(new D(this),e,t);if(!(r=this.c))return null;if(i=14*(o=r.length-1)+1,o=r[o]){for(;o%10==0;o/=10,i--);for(o=r[0];o>=10;o/=10,i++);}return e&&this.e+1>i&&(i=this.e+1),i},I.shiftedBy=function(e){return d(e,-9007199254740991,9007199254740991),this.times("1e"+e)},I.squareRoot=I.sqrt=function(){var e,t,r,i,o,n=this.c,s=this.s,a=this.e,u=P+4,h=new D("0.5");if(1!==s||!n||!n[0])return new D(!s||s<0&&(!n||n[0])?NaN:n?this:1/0);if(0==(s=Math.sqrt(+W(this)))||s==1/0?(((t=l(n)).length+a)%2==0&&(t+="0"),s=Math.sqrt(+t),a=c((a+1)/2)-(a<0||a%2),r=new D(t=s==1/0?"5e"+a:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+a)):r=new D(s+""),r.c[0]){for((s=(a=r.e)+u)<3&&(s=0);;)if(o=r,r=h.times(o.plus(S(this,o,u,1))),l(o.c).slice(0,s)===(t=l(r.c)).slice(0,s)){if(r.e<a&&--s,"9999"!=(t=t.slice(s-3,s+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(U(r,r.e+P+2,1),e=!r.times(r).eq(this));break}if(!i&&(U(o,o.e+P+2,0),o.times(o).eq(this))){r=o;break}u+=4,s+=4,i=1}}return U(r,r.e+P+1,B,e)},I.toExponential=function(e,t){return null!=e&&(d(e,0,1e9),e++),M(this,e,t,1)},I.toFixed=function(e,t){return null!=e&&(d(e,0,1e9),e=e+this.e+1),M(this,e,t)},I.toFormat=function(e,t,r){var i;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=T;else if("object"!=typeof r)throw Error(s+"Argument not an object: "+r);if(i=this.toFixed(e,t),this.c){var o,n=i.split("."),a=+r.groupSize,u=+r.secondaryGroupSize,c=r.groupSeparator||"",l=n[0],h=n[1],d=this.s<0,p=d?l.slice(1):l,f=p.length;if(u&&(o=a,a=u,u=o,f-=o),a>0&&f>0){for(o=f%a||a,l=p.substr(0,o);o<f;o+=a)l+=c+p.substr(o,a);u>0&&(l+=c+p.slice(o)),d&&(l="-"+l)}i=h?l+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?h.replace(RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):l}return(r.prefix||"")+i+(r.suffix||"")},I.toFraction=function(e){var t,r,i,o,n,a,c,h,d,p,f,m,g=this.c;if(null!=e&&(!(c=new D(e)).isInteger()&&(c.c||1!==c.s)||c.lt(A)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+W(c));if(!g)return new D(this);for(t=new D(A),d=r=new D(A),i=h=new D(A),m=l(g),n=t.e=m.length-this.e-1,t.c[0]=u[(a=n%14)<0?14+a:a],e=!e||c.comparedTo(t)>0?n>0?t:d:c,a=N,N=1/0,c=new D(m),h.c[0]=0;p=S(c,t,0,1),1!=(o=r.plus(p.times(i))).comparedTo(e);)r=i,i=o,d=h.plus(p.times(o=d)),h=o,t=c.minus(p.times(o=t)),c=o;return o=S(e.minus(r),i,0,1),h=h.plus(o.times(d)),r=r.plus(o.times(i)),h.s=d.s=this.s,n*=2,f=1>S(d,i,n,B).minus(this).abs().comparedTo(S(h,r,n,B).minus(this).abs())?[d,i]:[h,r],N=a,f},I.toNumber=function(){return+W(this)},I.toPrecision=function(e,t){return null!=e&&d(e,1,1e9),M(this,e,t,2)},I.toString=function(e){var t,r=this,i=r.s,o=r.e;return null===o?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=o<=E||o>=k?f(l(r.c),o):m(l(r.c),o,"0"):10===e&&z?t=m(l((r=U(new D(r),P+o+1,B)).c),r.e,"0"):(d(e,2,O.length,"Base"),t=x(m(l(r.c),o,"0"),10,e,i,!0)),i<0&&r.c[0]&&(t="-"+t)),t},I.valueOf=I.toJSON=function(){return W(this)},I._isBigNumber=!0,null!=t&&D.set(t),D}()).default=r.BigNumber=r,"function"==typeof define&&define.amd?define(function(){return r}):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(e)}}),ts=tr({"../../node_modules/json-bigint/lib/stringify.js"(e,t){var r=tn(),i=t.exports;!function(){var e,t,o,n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,function(e){var t=s[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}"function"!=typeof i.stringify&&(i.stringify=function(i,n,s){var u;if(e="",t="","number"==typeof s)for(u=0;u<s;u+=1)t+=" ";else"string"==typeof s&&(t=s);if(o=n,n&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw Error("JSON.stringify");return function i(n,s){var u,c,l,h,d,p=e,f=s[n],m=null!=f&&(f instanceof r||r.isBigNumber(f));switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(n)),"function"==typeof o&&(f=o.call(s,n,f)),typeof f){case"string":if(m)return f;return a(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":case"bigint":return String(f);case"object":if(!f)return"null";if(e+=t,d=[],"[object Array]"===Object.prototype.toString.apply(f)){for(u=0,h=f.length;u<h;u+=1)d[u]=i(u,f)||"null";return l=0===d.length?"[]":e?"[\n"+e+d.join(",\n"+e)+"\n"+p+"]":"["+d.join(",")+"]",e=p,l}if(o&&"object"==typeof o)for(u=0,h=o.length;u<h;u+=1)"string"==typeof o[u]&&(l=i(c=o[u],f))&&d.push(a(c)+(e?": ":":")+l);else Object.keys(f).forEach(function(t){var r=i(t,f);r&&d.push(a(t)+(e?": ":":")+r)});return l=0===d.length?"{}":e?"{\n"+e+d.join(",\n"+e)+"\n"+p+"}":"{"+d.join(",")+"}",e=p,l}}("",{"":i})})}()}}),ta=tr({"../../node_modules/json-bigint/lib/parse.js"(e,t){var r=null,i=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,o=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;t.exports=function(e){var t={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=e){if(!0===e.strict&&(t.strict=!0),!0===e.storeAsString&&(t.storeAsString=!0),t.alwaysParseAsBig=!0===e.alwaysParseAsBig&&e.alwaysParseAsBig,t.useNativeBigInt=!0===e.useNativeBigInt&&e.useNativeBigInt,void 0!==e.constructorAction){if("error"===e.constructorAction||"ignore"===e.constructorAction||"preserve"===e.constructorAction)t.constructorAction=e.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${e.constructorAction}`)}if(void 0!==e.protoAction){if("error"===e.protoAction||"ignore"===e.protoAction||"preserve"===e.protoAction)t.protoAction=e.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${e.protoAction}`)}}var n,s,a,u,c={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},l=function(e){throw{name:"SyntaxError",message:e,at:n,text:a}},h=function(e){return e&&e!==s&&l("Expected '"+e+"' instead of '"+s+"'"),s=a.charAt(n),n+=1,s},d=function(){var e,i="";for("-"===s&&(i="-",h("-"));s>="0"&&s<="9";)i+=s,h();if("."===s)for(i+=".";h()&&s>="0"&&s<="9";)i+=s;if("e"===s||"E"===s)for(i+=s,h(),("-"===s||"+"===s)&&(i+=s,h());s>="0"&&s<="9";)i+=s,h();if(isFinite(e=+i))return(null==r&&(r=tn()),i.length>15)?t.storeAsString?i:t.useNativeBigInt?BigInt(i):new r(i):t.alwaysParseAsBig?t.useNativeBigInt?BigInt(e):new r(e):e;l("Bad number")},p=function(){var e,t,r,i="";if('"'===s)for(var o=n;h();){if('"'===s)return n-1>o&&(i+=a.substring(o,n-1)),h(),i;if("\\"===s){if(n-1>o&&(i+=a.substring(o,n-1)),h(),"u"===s){for(t=0,r=0;t<4&&isFinite(e=parseInt(h(),16));t+=1)r=16*r+e;i+=String.fromCharCode(r)}else if("string"==typeof c[s])i+=c[s];else break;o=n}}l("Bad string")},f=function(){for(;s&&s<=" ";)h()},m=function(){switch(s){case"t":return h("t"),h("r"),h("u"),h("e"),!0;case"f":return h("f"),h("a"),h("l"),h("s"),h("e"),!1;case"n":return h("n"),h("u"),h("l"),h("l"),null}l("Unexpected '"+s+"'")},g=function(){var e=[];if("["===s){if(h("["),f(),"]"===s)return h("]"),e;for(;s;){if(e.push(u()),f(),"]"===s)return h("]"),e;h(","),f()}}l("Bad array")},y=function(){var e,r=Object.create(null);if("{"===s){if(h("{"),f(),"}"===s)return h("}"),r;for(;s;){if(e=p(),f(),h(":"),!0===t.strict&&Object.hasOwnProperty.call(r,e)&&l('Duplicate key "'+e+'"'),!0===i.test(e)?"error"===t.protoAction?l("Object contains forbidden prototype property"):"ignore"===t.protoAction?u():r[e]=u():!0===o.test(e)?"error"===t.constructorAction?l("Object contains forbidden constructor property"):"ignore"===t.constructorAction?u():r[e]=u():r[e]=u(),f(),"}"===s)return h("}"),r;h(","),f()}}l("Bad object")};return u=function(){switch(f(),s){case"{":return y();case"[":return g();case'"':return p();case"-":return d();default:return s>="0"&&s<="9"?d():m()}},function(e,t){var r;return a=e+"",n=0,s=" ",r=u(),f(),s&&l("Syntax error"),"function"==typeof t?function e(r,i){var o,n=r[i];return n&&"object"==typeof n&&Object.keys(n).forEach(function(t){void 0!==(o=e(n,t))?n[t]=o:delete n[t]}),t.call(r,i,n)}({"":r},""):r}}}}),tu=tr({"../../node_modules/json-bigint/index.js"(e,t){var r=ts().stringify,i=ta();t.exports=function(e){return{parse:i(e),stringify:r}},t.exports.parse=i(),t.exports.stringify=r}}),tc=tr({"../../node_modules/minimalistic-assert/index.js"(e,t){function r(e,t){if(!e)throw Error(t||"Assertion failed")}t.exports=r,r.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)}}}),tl=tr({"../../node_modules/inherits/inherits_browser.js"(e,t){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}}}),th=tr({"../../node_modules/inherits/inherits.js"(e,t){var r;try{if(r=tt("util"),"function"!=typeof r.inherits)throw"";t.exports=r.inherits}catch(e){t.exports=tl()}}}),td=tr({"../../node_modules/hash.js/lib/hash/utils.js"(e){var t=tc(),r=th();function i(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function o(e){return 1===e.length?"0"+e:e}function n(e){if(7===e.length)return"0"+e;if(6===e.length)return"00"+e;if(5===e.length)return"000"+e;if(4===e.length)return"0000"+e;if(3===e.length)return"00000"+e;if(2===e.length)return"000000"+e;if(1===e.length)return"0000000"+e;else return e}e.inherits=r,e.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e){if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e),o=0;o<e.length;o+=2)r.push(parseInt(e[o]+e[o+1],16))}else for(var i=0,o=0;o<e.length;o++){var n,s,a=e.charCodeAt(o);a<128?r[i++]=a:(a<2048?r[i++]=a>>6|192:((n=e,s=o,(64512&n.charCodeAt(s))!=55296||s<0||s+1>=n.length?1:(64512&n.charCodeAt(s+1))!=56320)?r[i++]=a>>12|224:(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++o)),r[i++]=a>>18|240,r[i++]=a>>12&63|128),r[i++]=a>>6&63|128),r[i++]=63&a|128)}}else for(o=0;o<e.length;o++)r[o]=0|e[o];return r},e.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=o(e[r].toString(16));return t},e.htonl=i,e.toHex32=function(e,t){for(var r="",o=0;o<e.length;o++){var s=e[o];"little"===t&&(s=i(s)),r+=n(s.toString(16))}return r},e.zero2=o,e.zero8=n,e.join32=function(e,r,i,o){var n,s=i-r;t(s%4==0);for(var a=Array(s/4),u=0,c=r;u<a.length;u++,c+=4)n="big"===o?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],a[u]=n>>>0;return a},e.split32=function(e,t){for(var r=Array(4*e.length),i=0,o=0;i<e.length;i++,o+=4){var n=e[i];"big"===t?(r[o]=n>>>24,r[o+1]=n>>>16&255,r[o+2]=n>>>8&255,r[o+3]=255&n):(r[o+3]=n>>>24,r[o+2]=n>>>16&255,r[o+1]=n>>>8&255,r[o]=255&n)}return r},e.rotr32=function(e,t){return e>>>t|e<<32-t},e.rotl32=function(e,t){return e<<t|e>>>32-t},e.sum32=function(e,t){return e+t>>>0},e.sum32_3=function(e,t,r){return e+t+r>>>0},e.sum32_4=function(e,t,r,i){return e+t+r+i>>>0},e.sum32_5=function(e,t,r,i,o){return e+t+r+i+o>>>0},e.sum64=function(e,t,r,i){var o=e[t],n=i+e[t+1]>>>0;e[t]=(n<i?1:0)+r+o>>>0,e[t+1]=n},e.sum64_hi=function(e,t,r,i){return(t+i>>>0<t?1:0)+e+r>>>0},e.sum64_lo=function(e,t,r,i){return t+i>>>0},e.sum64_4_hi=function(e,t,r,i,o,n,s,a){var u,c=t;return e+r+o+s+(0+((c=c+i>>>0)<t?1:0)+((c=c+n>>>0)<n?1:0)+((c=c+a>>>0)<a?1:0))>>>0},e.sum64_4_lo=function(e,t,r,i,o,n,s,a){return t+i+n+a>>>0},e.sum64_5_hi=function(e,t,r,i,o,n,s,a,u,c){var l,h=t;return e+r+o+s+u+(0+((h=h+i>>>0)<t?1:0)+((h=h+n>>>0)<n?1:0)+((h=h+a>>>0)<a?1:0)+((h=h+c>>>0)<c?1:0))>>>0},e.sum64_5_lo=function(e,t,r,i,o,n,s,a,u,c){return t+i+n+a+c>>>0},e.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},e.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},e.shr64_hi=function(e,t,r){return e>>>r},e.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}}}),tp=tr({"../../node_modules/hash.js/lib/hash/common.js"(e){var t=td(),r=tc();function i(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}e.BlockHash=i,i.prototype.update=function(e,r){if(e=t.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var i=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-i,e.length),0===this.pending.length&&(this.pending=null),e=t.join32(e,0,e.length-i,this.endian);for(var o=0;o<e.length;o+=this._delta32)this._update(e,o,o+this._delta32)}return this},i.prototype.digest=function(e){return this.update(this._pad()),r(null===this.pending),this._digest(e)},i.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,i=Array(r+this.padLength);i[0]=128;for(var o=1;o<r;o++)i[o]=0;if(e<<=3,"big"===this.endian){for(var n=8;n<this.padLength;n++)i[o++]=0;i[o++]=0,i[o++]=0,i[o++]=0,i[o++]=0,i[o++]=e>>>24&255,i[o++]=e>>>16&255,i[o++]=e>>>8&255,i[o++]=255&e}else for(n=8,i[o++]=255&e,i[o++]=e>>>8&255,i[o++]=e>>>16&255,i[o++]=e>>>24&255,i[o++]=0,i[o++]=0,i[o++]=0,i[o++]=0;n<this.padLength;n++)i[o++]=0;return i}}}),tf=tr({"../../node_modules/hash.js/lib/hash/sha/common.js"(e){var t=td().rotr32;function r(e,t,r){return e&t^e&r^t&r}e.ft_1=function(e,t,i,o){return 0===e?t&i^~t&o:1===e||3===e?t^i^o:2===e?r(t,i,o):void 0},e.ch32=function(e,t,r){return e&t^~e&r},e.maj32=r,e.p32=function(e,t,r){return e^t^r},e.s0_256=function(e){return t(e,2)^t(e,13)^t(e,22)},e.s1_256=function(e){return t(e,6)^t(e,11)^t(e,25)},e.g0_256=function(e){return t(e,7)^t(e,18)^e>>>3},e.g1_256=function(e){return t(e,17)^t(e,19)^e>>>10}}}),tm=tr({"../../node_modules/hash.js/lib/hash/sha/1.js"(e,t){var r=td(),i=tp(),o=tf(),n=r.rotl32,s=r.sum32,a=r.sum32_5,u=o.ft_1,c=i.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=Array(80)}r.inherits(h,c),t.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=n(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var o=this.h[0],c=this.h[1],h=this.h[2],d=this.h[3],p=this.h[4];for(i=0;i<r.length;i++){var f=~~(i/20),m=a(n(o,5),u(f,c,h,d),p,r[i],l[f]);p=d,d=h,h=n(c,30),c=o,o=m}this.h[0]=s(this.h[0],o),this.h[1]=s(this.h[1],c),this.h[2]=s(this.h[2],h),this.h[3]=s(this.h[3],d),this.h[4]=s(this.h[4],p)},h.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}}}),tg=tr({"../../node_modules/hash.js/lib/hash/sha/256.js"(e,t){var r=td(),i=tp(),o=tf(),n=tc(),s=r.sum32,a=r.sum32_4,u=r.sum32_5,c=o.ch32,l=o.maj32,h=o.s0_256,d=o.s1_256,p=o.g0_256,f=o.g1_256,m=i.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=Array(64)}r.inherits(y,m),t.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=a(f(r[i-2]),r[i-7],p(r[i-15]),r[i-16]);var o=this.h[0],m=this.h[1],g=this.h[2],y=this.h[3],w=this.h[4],v=this.h[5],b=this.h[6],S=this.h[7];for(n(this.k.length===r.length),i=0;i<r.length;i++){var x=u(S,d(w),c(w,v,b),this.k[i],r[i]),C=s(h(o),l(o,m,g));S=b,b=v,v=w,w=s(y,x),y=g,g=m,m=o,o=s(x,C)}this.h[0]=s(this.h[0],o),this.h[1]=s(this.h[1],m),this.h[2]=s(this.h[2],g),this.h[3]=s(this.h[3],y),this.h[4]=s(this.h[4],w),this.h[5]=s(this.h[5],v),this.h[6]=s(this.h[6],b),this.h[7]=s(this.h[7],S)},y.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}}}),ty=tr({"../../node_modules/hash.js/lib/hash/sha/224.js"(e,t){var r=td(),i=tg();function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(o,i),t.exports=o,o.blockSize=512,o.outSize=224,o.hmacStrength=192,o.padLength=64,o.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}}}),tw=tr({"../../node_modules/hash.js/lib/hash/sha/512.js"(e,t){var r=td(),i=tp(),o=tc(),n=r.rotr64_hi,s=r.rotr64_lo,a=r.shr64_hi,u=r.shr64_lo,c=r.sum64,l=r.sum64_hi,h=r.sum64_lo,d=r.sum64_4_hi,p=r.sum64_4_lo,f=r.sum64_5_hi,m=r.sum64_5_lo,g=i.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=Array(160)}r.inherits(w,g),t.exports=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(e,t){for(var r=this.W,i=0;i<32;i++)r[i]=e[t+i];for(;i<r.length;i+=2){var o=function(e,t){var r=n(e,t,19)^n(t,e,29)^a(e,t,6);return r<0&&(r+=4294967296),r}(r[i-4],r[i-3]),c=function(e,t){var r=s(e,t,19)^s(t,e,29)^u(e,t,6);return r<0&&(r+=4294967296),r}(r[i-4],r[i-3]),l=r[i-14],h=r[i-13],f=function(e,t){var r=n(e,t,1)^n(e,t,8)^a(e,t,7);return r<0&&(r+=4294967296),r}(r[i-30],r[i-29]),m=function(e,t){var r=s(e,t,1)^s(e,t,8)^u(e,t,7);return r<0&&(r+=4294967296),r}(r[i-30],r[i-29]),g=r[i-32],y=r[i-31];r[i]=d(o,c,l,h,f,m,g,y),r[i+1]=p(o,c,l,h,f,m,g,y)}},w.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,i=this.h[0],a=this.h[1],u=this.h[2],d=this.h[3],p=this.h[4],g=this.h[5],y=this.h[6],w=this.h[7],v=this.h[8],b=this.h[9],S=this.h[10],x=this.h[11],C=this.h[12],I=this.h[13],A=this.h[14],P=this.h[15];o(this.k.length===r.length);for(var B=0;B<r.length;B+=2){var E=A,k=P,V=function(e,t){var r=n(e,t,14)^n(e,t,18)^n(t,e,9);return r<0&&(r+=4294967296),r}(v,b),N=function(e,t){var r=s(e,t,14)^s(e,t,18)^s(t,e,9);return r<0&&(r+=4294967296),r}(v,b),H=function(e,t,r,i,o){var n=e&r^~e&o;return n<0&&(n+=4294967296),n}(v,0,S,0,C,I),R=function(e,t,r,i,o,n){var s=t&i^~t&n;return s<0&&(s+=4294967296),s}(0,b,0,x,0,I),_=this.k[B],T=this.k[B+1],O=r[B],z=r[B+1],D=f(E,k,V,N,H,R,_,T,O,z),M=m(E,k,V,N,H,R,_,T,O,z);E=function(e,t){var r=n(e,t,28)^n(t,e,2)^n(t,e,7);return r<0&&(r+=4294967296),r}(i,a);var j=l(E,k=function(e,t){var r=s(e,t,28)^s(t,e,2)^s(t,e,7);return r<0&&(r+=4294967296),r}(i,a),V=function(e,t,r,i,o){var n=e&r^e&o^r&o;return n<0&&(n+=4294967296),n}(i,0,u,0,p,g),N=function(e,t,r,i,o,n){var s=t&i^t&n^i&n;return s<0&&(s+=4294967296),s}(0,a,0,d,0,g)),K=h(E,k,V,N);A=C,P=I,C=S,I=x,S=v,x=b,v=l(y,w,D,M),b=h(w,w,D,M),y=p,w=g,p=u,g=d,u=i,d=a,i=l(D,M,j,K),a=h(D,M,j,K)}c(this.h,0,i,a),c(this.h,2,u,d),c(this.h,4,p,g),c(this.h,6,y,w),c(this.h,8,v,b),c(this.h,10,S,x),c(this.h,12,C,I),c(this.h,14,A,P)},w.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}}}),tv=tr({"../../node_modules/hash.js/lib/hash/sha/384.js"(e,t){var r=td(),i=tw();function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(o,i),t.exports=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}}}),tb=tr({"../../node_modules/hash.js/lib/hash/sha.js"(e){e.sha1=tm(),e.sha224=ty(),e.sha256=tg(),e.sha384=tv(),e.sha512=tw()}}),tS=tr({"../../node_modules/hash.js/lib/hash/ripemd.js"(e){var t=td(),r=tp(),i=t.rotl32,o=t.sum32,n=t.sum32_3,s=t.sum32_4,a=r.BlockHash;function u(){if(!(this instanceof u))return new u;a.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function c(e,t,r,i){return e<=15?t^r^i:e<=31?t&r|~t&i:e<=47?(t|~r)^i:e<=63?t&i|r&~i:t^(r|~i)}t.inherits(u,a),e.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var r=this.h[0],a=this.h[1],u=this.h[2],f=this.h[3],m=this.h[4],g=r,y=a,w=u,v=f,b=m,S=0;S<80;S++){var x,C,I=o(i(s(r,c(S,a,u,f),e[l[S]+t],(x=S)<=15?0:x<=31?1518500249:x<=47?1859775393:x<=63?2400959708:2840853838),d[S]),m);r=m,m=f,f=i(u,10),u=a,a=I,I=o(i(s(g,c(79-S,y,w,v),e[h[S]+t],(C=S)<=15?1352829926:C<=31?1548603684:C<=47?1836072691:C<=63?2053994217:0),p[S]),b),g=b,b=v,v=i(w,10),w=y,y=I}I=n(this.h[1],u,v),this.h[1]=n(this.h[2],f,b),this.h[2]=n(this.h[3],m,g),this.h[3]=n(this.h[4],r,y),this.h[4]=n(this.h[0],a,w),this.h[0]=I},u.prototype._digest=function(e){return"hex"===e?t.toHex32(this.h,"little"):t.split32(this.h,"little")};var l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],d=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],p=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}}),tx=tr({"../../node_modules/hash.js/lib/hash/hmac.js"(e,t){var r=td(),i=tc();function o(e,t,i){if(!(this instanceof o))return new o(e,t,i);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(t,i))}t.exports=o,o.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(t=0,this.inner=new this.Hash().update(e);t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)},o.prototype.update=function(e,t){return this.inner.update(e,t),this},o.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}}}),tC=tr({"../../node_modules/hash.js/lib/hash.js"(e){e.utils=td(),e.common=tp(),e.sha=tb(),e.ripemd=tS(),e.hmac=tx(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}}),tI=n.g7,tA=s.B,tP=a.YW,tB=e=>u.az(e),tE=c.r,tk=l.X,tV=h.TO,tN=d.T,tH=p.k,tR=f.M,t_=m.Z,tT=g.X,tO=y.H,tz=w.$,tD=v.h,tM=b.F,tj=S.F,tK=x.O;u.by;var tU=C.Q,tW=I.X,tL=A.RC,tq=A.Jf,tF=A.xW;ea.iO;var tZ=P.kL,t$=B.m,tG=P.DL,tJ=E.p,tY=k.Z;V.hw,A.vC,N.h;var tX=ea._K,tQ=e=>(0,em.PS)(e,64);eu._;var t0=ea._J,t1=ea.iO,t2=e=>ea.yx(e),t3=P.d3,t4=H.K,t5=R.A2;_.X,T.Y,O.ny;var t9=z.I,t6=ea.jM,t7=ec.E,t8=el.A,re=eh.B,rt=ea._D;ed.J,ea.TM;var rr=D.al,ri=M.$,ro=j.Z,rn=K.$,rs=U.z;W.W,L.gd,L.WX,L.VH,q.o,F.a;var ra=Z.M,ru=$.L,rc=G.e;J.k;var rl=e=>ea.yx(e),rh=Y.yq,rd=X.Y,rp=Q.B9;Y.cn;var rf=ee.A;D.Aw.RequireAllOf,D.Aw.RequireAnyOf,D.Aw.RequireNOf,D.Aw.RequireSignature,D.Aw.RequireTimeAfter,D.Aw.RequireTimeBefore,n.S_,et.E,er.Y;var rm=ei.J;eo.nc;var rg=em.sZ;a.K$;var ry=ep.qN,rw=en.b,rv=es.z,rb=to(tu(),1),rS=class e{protectedMap;unProtectedMap;payload;signature;constructor(e){this.protectedMap=e.protectedMap,this.unProtectedMap=e.unProtectedMap,this.payload=e.payload,this.unProtectedMap.map.find(e=>rb.default.stringify(e.k)===rb.default.stringify(new ew.CborText("hashed")))||this.unProtectedMap.map.push({k:new ew.CborText("hashed"),v:new ew.CborSimple(!1)}),this.signature=e.signature}static fromCbor(t){let r;let i=ew.Cbor.parse(t);if(!(0,ew.isRawCborArray)(i.toRawObj()))throw Error("Invalid CBOR");if(4!==i.array.length)throw Error("Invalid COSE_SIGN1");let o=i.array[0];try{if(r=ew.Cbor.parse(o.bytes),!(0,ew.isRawCborMap)(r.toRawObj()))throw Error()}catch(e){throw Error("Invalid protected")}let n=i.array[1];if(!(0,ew.isRawCborMap)(n.toRawObj()))throw Error("Invalid unprotected");return new e({protectedMap:r,unProtectedMap:n,payload:i.array[2],signature:i.array[3]})}createSigStructure(e=ey.Buffer.alloc(0)){let t=new ew.CborBytes(ey.Buffer.alloc(0));if(0!==this.protectedMap.map.length&&(t=new ew.CborBytes(ew.Cbor.encode(this.protectedMap).toBuffer())),!this.payload)throw Error("Invalid payload");let r=new ew.CborArray([new ew.CborText("Signature1"),t,new ew.CborBytes(e),this.payload]);return ey.Buffer.from(ew.Cbor.encode(r).toBuffer())}buildMessage(e){this.signature=new ew.CborBytes(e);let t=new ew.CborBytes(ey.Buffer.alloc(0));if(0!==this.protectedMap.map.length&&(t=new ew.CborBytes(ew.Cbor.encode(this.protectedMap).toBuffer())),!this.payload)throw Error("Invalid payload");let r=new ew.CborArray([t,this.unProtectedMap,this.payload,this.signature]);return ey.Buffer.from(ew.Cbor.encode(r).toBuffer())}verifySignature({externalAad:e=ey.Buffer.alloc(0),publicKeyBuffer:t}={}){if(t||(t=this.getPublicKey()),!t)throw Error("Public key not found");if(!this.signature)throw Error("Signature not found");return new t7(t).verify(new t8(this.signature.bytes),rg(ey.Buffer.from(this.createSigStructure(e)).toString("hex")))}hashPayload(){if(!this.unProtectedMap)throw Error("Invalid unprotected map");if(!this.payload)throw Error("Invalid payload");let e=this.unProtectedMap.map.findIndex(e=>rb.default.stringify(e.k)===rb.default.stringify(new ew.CborText("hashed"))),t=this.unProtectedMap.map[e];if(t&&rb.default.stringify(t.v)===rb.default.stringify(new ew.CborSimple(!0)))throw Error("Payload already hashed");if(t&&rb.default.stringify(t.v)===rb.default.stringify(new ew.CborSimple(!0))!=!1)throw Error("Invalid unprotected map");this.unProtectedMap.map.splice(e,1);let r=(0,ev.blake2b)(this.payload.bytes,void 0,24);this.payload=new ew.CborBytes(r)}getAddress(){let e=this.protectedMap.map.find(e=>rb.default.stringify(e.k)===rb.default.stringify(new ew.CborText("address")));if(!e)throw Error("Address not found");return ey.Buffer.from(e.v.bytes)}getPublicKey(){let e=this.protectedMap.map.find(e=>rb.default.stringify(e.k)===rb.default.stringify(new ew.CborUInt(4)));if(!e)throw Error("Public key not found");return ey.Buffer.from(e.v.bytes)}getSignature(){return this.signature?ey.Buffer.from(this.signature.bytes):this.signature}getPayload(){return this.payload?ey.Buffer.from(this.payload.bytes):this.payload}},rx=e=>{let t=[];return t.push({k:new ew.CborUInt(1),v:new ew.CborUInt(1)}),t.push({k:new ew.CborUInt(3),v:new ew.CborNegInt(-8)}),t.push({k:new ew.CborNegInt(-1),v:new ew.CborUInt(6)}),t.push({k:new ew.CborNegInt(-2),v:new ew.CborBytes(ey.Buffer.from(e,"hex"))}),ey.Buffer.from(ew.Cbor.encode(new ew.CborMap(t)).toBuffer())},rC=(e,t)=>{let r=(0,eg.A7)(e)?e:(0,eg.zm)(e),i=e4.from(r,"hex"),o=e4.from(t.key.toPublic().bytes()),n=[];n.push({k:new ew.CborUInt(1),v:new ew.CborNegInt(-8)}),n.push({k:new ew.CborUInt(4),v:new ew.CborBytes(o)}),n.push({k:new ew.CborText("address"),v:new ew.CborBytes(e4.from(t.address.toBytes(),"hex"))});let s=new rS({protectedMap:new ew.CborMap(n),unProtectedMap:new ew.CborMap([]),payload:new ew.CborBytes(i)}),a=t.key.sign(rg(e4.from(s.createSigStructure()).toString("hex"))),u=s.buildMessage(e4.from(a.bytes())).toString("hex");return{key:rx(o.toString("hex")).toString("hex"),signature:u}},rI=to(tC(),1),rA=(e,t,r)=>tJ.fromCredentials(e,{hash:t,type:t3.KeyHash},{hash:r,type:t3.KeyHash}),rP=(e,t)=>tY.fromCredentials(e,{hash:t,type:t3.KeyHash}),rB=e=>(void 0!==e[0]&&(e[0]&=248),void 0!==e[31]&&(e[31]&=31,e[31]|=64),e),rE=(e,t="")=>{let r=e4.from(e,"hex"),i=(0,eb.pbkdf2Sync)(t,r,4096,96,"sha512");return re.fromBytes(rB(i))},rk=(e,t)=>{let r={type:t3.KeyHash,hash:t};return t$.fromCredentials(e,r)},rV=(e,t,r=0)=>{if("string"==typeof e){let i=re.fromHex(rt(e)).derive([eg.pM+1852,eg.pM+1815,eg.pM+t]);return{paymentKey:i.derive([0,r]).toRawKey(),stakeKey:i.derive([2,0]).toRawKey(),dRepKey:i.derive([3,r]).toRawKey()}}return{paymentKey:ry.fromNormalHex(tQ(e[0])),stakeKey:ry.fromNormalHex(tQ(e[1]))}},rN=e=>ry.fromExtendedBytes(new Uint8Array(rB(e4.from(rI.default.sha512().update(e4.from(e,"hex")).digest())))),rH=(e,t=rp.Testnet,r=tG.EnterpriseKey)=>{let i=e4.from(e,"hex"),o=ef(28).update(i).digest("hex"),n=tY.packParts({networkId:t,paymentPart:{hash:t1(o),type:t3.KeyHash},type:r});return em.sZ.toTypedBech32("drep",em.sZ.fromBytes(n))},rR=e=>{let t=e=>{let t=new tD;return e.forEach(e=>{t.add(rR(e))}),t};switch(typeof e){case"string":return tz.newBytes((0,eg.O0)(e));case"number":case"bigint":return tz.newInteger(BigInt(e));case"object":if(e instanceof Array){let r=t(e);return tz.newList(r)}if(!(e instanceof Map))return tz.newConstrPlutusData(new ru(BigInt(e.alternative),t(e.fields)));{let t=new tM;return e.forEach((e,r)=>{t.insert(rR(r),rR(e))}),tz.newMap(t)}}},r_=e=>"object"==typeof e&&"constructor"in e&&("number"==typeof e.constructor||"bigint"==typeof e.constructor||"string"==typeof e.constructor)&&"fields"in e&&Array.isArray(e.fields),rT=e=>{if(r_(e)){let t=new tD;e.fields.map(e=>{t.add(rT(e))});let r=new ru(BigInt(e.constructor),t);return tz.newConstrPlutusData(r)}if("int"in e&&1===Object.keys(e).length){if("bigint"==typeof e.int||"number"==typeof e.int||"string"==typeof e.int)return tz.newInteger(BigInt(e.int));throw Error("Malformed int field in Plutus data, expected one of bigint, number or string")}if("bytes"in e&&1===Object.keys(e).length){if("string"==typeof e.bytes)return tz.newBytes(e4.from(e.bytes,"hex"));throw Error("Malformed bytes field in Plutus data, expected string")}if("list"in e&&1===Object.keys(e).length){if(Array.isArray(e.list)){let t=new tD;return e.list.map(e=>{t.add(rT(e))}),tz.newList(t)}throw Error("Malformed list field in Plutus data, expected list")}if("map"in e&&1===Object.keys(e).length){var t;if("object"==typeof(t=e.map)&&Array.isArray(t)){let t=new tM;return e.map.forEach(e=>{if("object"==typeof e&&"k"in e&&"object"==typeof e.k&&"v"in e&&"object"==typeof e.v)t.insert(rT(e.k),rT(e.v));else throw Error("Malformed key value pair in Plutus data map")}),tz.newMap(t)}throw console.log(e),Error("Malformed map field in Plutus data")}throw Error("Malformed Plutus data json")},rO=e=>{if("Mesh"===e.type)return rR(e.content);if("CBOR"===e.type)return tz.fromCbor((0,em.sZ)(e.content));if("JSON"===e.type)return rT("string"==typeof e.content?JSON.parse(e.content):e.content);throw Error("Malformed builder data, expected types of, Mesh, CBOR or JSON")},rz=e=>t_.fromCbor((0,em.sZ)(e)),rD=e=>tA.fromCbor((0,em.sZ)(e)),rM=e=>tP.fromCbor(a.K$(e)),rj=e=>tB(e),rK=e=>tZ.fromBech32(e),rU=e=>{try{return tZ.fromBech32(e)}catch{try{return tZ.fromBase58(e)}catch{throw Error(`Invalid address format, ${e}`)}}},rW=e=>{let t=e.output().datum()?e.output().datum()?.toCbor().toString():void 0,r=e.output().scriptRef()?e.output().scriptRef()?.toCbor().toString():void 0,i=e.output().datum()?.asInlineData()?e.output().datum()?.asInlineData()?.toCbor().toString():void 0;return{input:{outputIndex:Number(e.input().index()),txHash:e.input().transactionId()},output:{address:e.output().address().toBech32(),amount:rq(e.output().amount()),dataHash:t,plutusData:i,scriptRef:r}}},rL=e=>e.toBech32(),rq=e=>{let t=[{unit:"lovelace",quantity:e.coin().toString()}],r=e.multiasset();if(void 0!==r){let e=Array.from(r.keys());for(let i=0;i<e.length;i+=1){let o=e[i];if(void 0!==o){let e=r.get(o);void 0!==e&&t.push({unit:o,quantity:e.toString()})}}}return t},rF=e=>{let t=e=>{let t=[];return e.forEach(e=>{t.push(rF(e))}),t};switch(e.type){case"all":return ri.newScriptAll(new eC._(t(e.scripts)));case"any":return ri.newScriptAny(new eI.f(t(e.scripts)));case"atLeast":return ri.newScriptNOfK(new eA.e(t(e.scripts),e.required));case"after":return ri.newTimelockStart(new eP.Y(tI(parseInt(e.slot))));case"before":return ri.newTimelockExpiry(new eB.G(tI(parseInt(e.slot))));case"sig":return ri.newScriptPubkey(new et.E(eu._.fromBytes((0,eg.O0)(e.keyHash)).hex()))}},rZ=e=>{let t=new Map;e.filter(e=>"lovelace"!==e.unit&&""!==e.unit).forEach(e=>{t.set(tF(e.unit),BigInt(e.quantity))});let r=e.find(e=>"lovelace"===e.unit||""===e.unit),i=new tA(BigInt(r?r.quantity:0));return(e.length>1||!r)&&i.setMultiasset(t),i},r$=e=>{if(58===e.length){let{prefix:t,words:r}=ex.bech32.decode(e);if("drep"!==t)throw Error("Invalid DRepId prefix");let i=eS.decode(new Uint8Array(r));if(34===i[0])return ei.J.newKeyHash(t0(i.subarray(1).toString("hex")));if(35===i[0])return ei.J.newScriptHash(t1(i.subarray(1).toString("hex")));throw Error("Malformed CIP129 DRepId")}{let{prefix:t,words:r}=ex.bech32.decode(e);switch(t){case"drep":return ei.J.newKeyHash(t0(eS.decode(new Uint8Array(r)).toString("hex")));case"drep_script":return ei.J.newScriptHash(t1(eS.decode(new Uint8Array(r)).toString("hex")));default:throw Error("Malformed DRepId prefix")}}},rG=e=>{switch(e){case"V1":return rr.V1;case"V2":return rr.V2;case"V3":return rr.V3}},rJ=e=>{let t=tZ.fromString(e);if(null===t)throw Error("Invalid address");return t},rY=e=>e4.from(e,"hex"),rX=(e,t)=>{let r=e4.from(t,"hex"),i=eS.encode(r);return ex.bech32.encode(e,i)},rQ=e=>({url:e.anchorUrl,dataHash:t2(e.anchorDataHash)}),r0=e=>e?{id:u.az(e.transactionId),actionIndex:e.govActionIndex}:null,r1=e=>"KeyHash"===e.type?{type:t3.KeyHash,hash:t1(e.keyHash)}:{type:t3.ScriptHash,hash:t1(e.scriptHash)},r2=e=>({numerator:Number(e.numerator),denominator:Number(e.denominator)}),r3=e=>`${Number(e.numerator)/Number(e.denominator)}`,r4=e=>{let t=new Map;for(let[r,i]of Object.entries(e))t.set(rG(r),i);return t},r5=e=>{let t={};if(void 0!==e.minFeeA&&(t.minFeeCoefficient=Number(e.minFeeA)),void 0!==e.minFeeB&&(t.minFeeConstant=Number(e.minFeeB)),void 0!==e.maxBlockBodySize&&(t.maxBlockBodySize=Number(e.maxBlockBodySize)),void 0!==e.maxTxSize&&(t.maxTxSize=Number(e.maxTxSize)),void 0!==e.maxBlockHeaderSize&&(t.maxBlockHeaderSize=Number(e.maxBlockHeaderSize)),void 0!==e.keyDeposit&&(t.stakeKeyDeposit=Number(e.keyDeposit)),void 0!==e.poolDeposit&&(t.poolDeposit=Number(e.poolDeposit)),void 0!==e.maxEpoch&&(t.poolRetirementEpochBound=Number(e.maxEpoch)),void 0!==e.nOpt&&(t.desiredNumberOfPools=Number(e.nOpt)),void 0!==e.poolPledgeInfluence&&(t.poolInfluence=r3(e.poolPledgeInfluence)),void 0!==e.expansionRate&&(t.monetaryExpansion=r3(e.expansionRate)),void 0!==e.treasuryGrowthRate&&(t.treasuryExpansion=r3(e.treasuryGrowthRate)),void 0!==e.minPoolCost&&(t.minPoolCost=Number(e.minPoolCost)),void 0!==e.adaPerUtxoByte&&(t.coinsPerUtxoByte=Number(e.adaPerUtxoByte)),void 0!==e.costModels&&(t.costModels=r4(e.costModels)),void 0!==e.executionCosts){let r=e.executionCosts.memPrice?Number(e.executionCosts.memPrice.numerator)/Number(e.executionCosts.memPrice.denominator):void 0,i=e.executionCosts.stepPrice?Number(e.executionCosts.stepPrice.numerator)/Number(e.executionCosts.stepPrice.denominator):void 0;(void 0!==r||void 0!==i)&&(t.prices={memory:r,steps:i})}if(void 0!==e.maxTxExUnits&&(t.maxExecutionUnitsPerTransaction={memory:Number(e.maxTxExUnits.mem),steps:Number(e.maxTxExUnits.steps)}),void 0!==e.maxBlockExUnits&&(t.maxExecutionUnitsPerBlock={memory:Number(e.maxBlockExUnits.mem),steps:Number(e.maxBlockExUnits.steps)}),void 0!==e.maxValueSize&&(t.maxValueSize=Number(e.maxValueSize)),void 0!==e.collateralPercentage&&(t.collateralPercentage=Number(e.collateralPercentage)),void 0!==e.maxCollateralInputs&&(t.maxCollateralInputs=Number(e.maxCollateralInputs)),void 0!==e.poolVotingThresholds){let r={};void 0!==e.poolVotingThresholds.motionNoConfidence&&(r.motionNoConfidence=r2(e.poolVotingThresholds.motionNoConfidence)),void 0!==e.poolVotingThresholds.committeeNormal&&(r.committeeNormal=r2(e.poolVotingThresholds.committeeNormal)),void 0!==e.poolVotingThresholds.committeeNoConfidence&&(r.committeeNoConfidence=r2(e.poolVotingThresholds.committeeNoConfidence)),void 0!==e.poolVotingThresholds.hardForkInitiation&&(r.hardForkInitiation=r2(e.poolVotingThresholds.hardForkInitiation)),void 0!==e.poolVotingThresholds.ppSecurityGroup&&(r.securityRelevantParamVotingThreshold=r2(e.poolVotingThresholds.ppSecurityGroup)),Object.keys(r).length>0&&(t.poolVotingThresholds=r)}if(void 0!==e.drepVotingThresholds){let r={};void 0!==e.drepVotingThresholds.motionNoConfidence&&(r.motionNoConfidence=r2(e.drepVotingThresholds.motionNoConfidence)),void 0!==e.drepVotingThresholds.committeeNormal&&(r.committeeNormal=r2(e.drepVotingThresholds.committeeNormal)),void 0!==e.drepVotingThresholds.committeeNoConfidence&&(r.committeeNoConfidence=r2(e.drepVotingThresholds.committeeNoConfidence)),void 0!==e.drepVotingThresholds.updateConstitution&&(r.updateConstitution=r2(e.drepVotingThresholds.updateConstitution)),void 0!==e.drepVotingThresholds.hardForkInitiation&&(r.hardForkInitiation=r2(e.drepVotingThresholds.hardForkInitiation)),void 0!==e.drepVotingThresholds.ppNetworkGroup&&(r.ppNetworkGroup=r2(e.drepVotingThresholds.ppNetworkGroup)),void 0!==e.drepVotingThresholds.ppEconomicGroup&&(r.ppEconomicGroup=r2(e.drepVotingThresholds.ppEconomicGroup)),void 0!==e.drepVotingThresholds.ppTechnicalGroup&&(r.ppTechnicalGroup=r2(e.drepVotingThresholds.ppTechnicalGroup)),void 0!==e.drepVotingThresholds.ppGovGroup&&(r.ppGovernanceGroup=r2(e.drepVotingThresholds.ppGovGroup)),void 0!==e.drepVotingThresholds.treasuryWithdrawal&&(r.treasuryWithdrawal=r2(e.drepVotingThresholds.treasuryWithdrawal)),Object.keys(r).length>0&&(t.dRepVotingThresholds=r)}return void 0!==e.minCommitteeSize&&(t.minCommitteeSize=Number(e.minCommitteeSize)),void 0!==e.committeeTermLimit&&(t.committeeTermLimit=n.Ys(e.committeeTermLimit)),void 0!==e.govActionValidityPeriod&&(t.governanceActionValidityPeriod=n.Ys(e.govActionValidityPeriod)),void 0!==e.govActionDeposit&&(t.governanceActionDeposit=Number(e.govActionDeposit)),void 0!==e.drepDeposit&&(t.dRepDeposit=Number(e.drepDeposit)),void 0!==e.drepInactivityPeriod&&(t.dRepInactivityPeriod=n.Ys(e.drepInactivityPeriod)),void 0!==e.refScriptCostPerByte&&(t.minFeeRefScriptCostPerByte=r3(e.refScriptCostPerByte)),t},r9=e=>{let t=[];for(let r of e.members)t.push({coldCredential:r1(r.stakeCredential),epoch:n.Ys(r.termLimit)});return{members:t,quorumThreshold:r2(e.quorumThreshold)}},r6=e=>{let t=null;return e.scriptHash&&(t=t1(e.scriptHash.bytes)),{anchor:rQ(e.anchor),scriptHash:t}},r7=e=>{let t=new Set;for(let[r,i]of Object.entries(e)){let e=rK(r);if(!e)throw Error(`Invalid reward address: ${r}`);let o=e.getType();if(!(o===tG.RewardKey||o===tG.RewardScript))throw Error(`Address is not a reward address: ${r}`);let n=BigInt(i);t.add({rewardAccount:rc(e.toBech32()),coin:n})}return t},r8=(e,t,r,i)=>{let o;let n=rK(r);if(!n)throw Error(`Invalid reward account: ${r}`);let s=n.getType();if(!(s===tG.RewardKey||s===tG.RewardScript))throw Error(`Address is not a reward address: ${r}`);let a=rc(n.toBech32()),u=rQ(t);switch(e.kind){case"ParameterChangeAction":{let t=e.action;o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.parameter_change_action,governanceActionId:r0(t.govActionId),protocolParamUpdate:r5(t.protocolParamUpdates),policyHash:t.policyHash?t1(t.policyHash.bytes):null}};break}case"HardForkInitiationAction":{let t=e.action;o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.hard_fork_initiation_action,governanceActionId:r0(t.govActionId),protocolVersion:{major:t.protocolVersion.major,minor:t.protocolVersion.minor}}};break}case"TreasuryWithdrawalsAction":{let t=e.action;o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.treasury_withdrawals_action,withdrawals:r7(t.withdrawals),policyHash:t.policyHash?t1(t.policyHash.bytes):null}};break}case"NoConfidenceAction":{let t=e.action;o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.no_confidence,governanceActionId:r0(t.govActionId)}};break}case"UpdateCommitteeAction":{let t=e.action,r=new Set;for(let e of t.membersToRemove)r.add(r1(e));let n=r9(t.committee);o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.update_committee,governanceActionId:r0(t.govActionId),membersToBeRemoved:r,membersToBeAdded:new Set(n.members),newQuorumThreshold:n.quorumThreshold}};break}case"NewConstitutionAction":{let t=e.action;o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.new_constitution,governanceActionId:r0(t.govActionId),constitution:r6(t.constitution)}};break}case"InfoAction":o={anchor:u,deposit:i,rewardAccount:a,governanceAction:{__typename:eE.mc.info_action}}}return ek.I.fromCore(o)},ie=(e,t="Mesh")=>rO({content:e,type:t}).hash().toString(),it=e=>{let t=rM(e).body(),r=ef(ef.BYTES).update(rY(t.toCbor())).digest();return u.az.fromHexBlob(em.sZ.fromBytes(r)).toString()},ir=e=>{switch(e.type){case"RegisterPool":{let t=[];for(let r of e.poolParams.relays)switch(r.type){case"SingleHostAddr":t.push(eR.Z.newSingleHostAddr(new e_.h(r.port,r.IPV4,r.IPV6)));break;case"SingleHostName":t.push(eR.Z.newSingleHostName(new eT.e(r.domainName,r.port)));break;case"MultiHostName":t.push(eR.Z.newMultiHostName(new eO.A(r.domainName)))}let r=ee.A.fromCore([],J.k.fromCore),i=[...r.values()];for(let t of e.poolParams.owners)i.push(J.k.fromCore(t0(t)));r.setValues(i);let o=B.m.fromAddress(P.kL.fromBech32(e.poolParams.rewardAddress));if(void 0===o)throw Error("Error parsing reward address, it is expected to be in bech32 format");let n=e.poolParams.metadata?new ez.y(e.poolParams.metadata.URL,ea.yx(e.poolParams.metadata.hash)):void 0;return t4.newPoolRegistration(new eD.M(new eM.W(t0(e.poolParams.operator),R.KW(e.poolParams.vrfKeyHash),BigInt(e.poolParams.pledge),BigInt(e.poolParams.cost),new ej.r(BigInt(e.poolParams.margin[0]),BigInt(e.poolParams.margin[1])),o,r,t,n)))}case"RegisterStake":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");return t4.newStakeRegistration(new _.X(t.getPaymentCredential()))}case"DelegateStake":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");return t4.newStakeDelegation(new T.Y(t.getPaymentCredential(),e.poolId.startsWith("pool1")?R.A2.toKeyHash(R.A2(e.poolId)):t0(e.poolId)))}case"DeregisterStake":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");return t4.newStakeDeregistration(new eK.C(t.getPaymentCredential()))}case"RetirePool":return t4.newPoolRetirement(new eU.U(e.poolId.startsWith("pool1")?R.A2.toKeyHash(R.A2(e.poolId)):t0(e.poolId),n.Ys(e.epoch)));case"VoteDelegation":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");if(void 0!==e.drep.dRepId)return t4.newVoteDelegationCert(new eW.E(t.getPaymentCredential(),r$(e.drep.dRepId)));if(void 0!==e.drep.alwaysAbstain)return t4.newVoteDelegationCert(new eW.E(t.getPaymentCredential(),ei.J.newAlwaysAbstain()));if(void 0!==e.drep.alwaysNoConfidence)return t4.newVoteDelegationCert(new eW.E(t.getPaymentCredential(),ei.J.newAlwaysNoConfidence()));throw Error("Malformed DRep type")}case"StakeAndVoteDelegation":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");if(void 0!==e.drep.dRepId)return t4.newStakeVoteDelegationCert(new eL.Z(t.getPaymentCredential(),r$(e.drep.dRepId),t0(e.poolKeyHash)));if(void 0!==e.drep.alwaysAbstain)return t4.newStakeVoteDelegationCert(new eL.Z(t.getPaymentCredential(),ei.J.newAlwaysAbstain(),t0(e.poolKeyHash)));if(void 0!==e.drep.alwaysNoConfidence)return t4.newStakeVoteDelegationCert(new eL.Z(t.getPaymentCredential(),ei.J.newAlwaysNoConfidence(),t0(e.poolKeyHash)));throw Error("Malformed DRep type")}case"StakeRegistrationAndDelegation":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");return t4.newStakeRegistrationDelegationCert(new eq.T(t.getPaymentCredential(),BigInt(e.coin),t0(e.poolKeyHash)))}case"VoteRegistrationAndDelegation":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");if(void 0!==e.drep.dRepId)return t4.newVoteRegistrationDelegationCert(new eF.V(t.getPaymentCredential(),BigInt(e.coin),r$(e.drep.dRepId)));if(void 0!==e.drep.alwaysAbstain)return t4.newVoteRegistrationDelegationCert(new eF.V(t.getPaymentCredential(),BigInt(e.coin),ei.J.newAlwaysAbstain()));if(void 0!==e.drep.alwaysNoConfidence)return t4.newVoteRegistrationDelegationCert(new eF.V(t.getPaymentCredential(),BigInt(e.coin),ei.J.newAlwaysNoConfidence()));throw Error("Malformed DRep type")}case"StakeVoteRegistrationAndDelegation":{let t=B.m.fromAddress(P.kL.fromBech32(e.stakeKeyAddress));if(void 0===t)throw Error("Error parsing reward address, it is expected to be in bech32 format");if(void 0!==e.drep.dRepId)return t4.newStakeVoteDelegationCert(new eL.Z(t.getPaymentCredential(),r$(e.drep.dRepId),t0(e.poolKeyHash)));if(void 0!==e.drep.alwaysAbstain)return t4.newStakeVoteDelegationCert(new eL.Z(t.getPaymentCredential(),ei.J.newAlwaysAbstain(),t0(e.poolKeyHash)));if(void 0!==e.drep.alwaysNoConfidence)return t4.newStakeVoteDelegationCert(new eL.Z(t.getPaymentCredential(),ei.J.newAlwaysNoConfidence(),t0(e.poolKeyHash)));throw Error("Malformed DRep type")}case"CommitteeHotAuth":{let t=P.kL.fromBech32(e.committeeHotKeyAddress).getProps().paymentPart,r=P.kL.fromBech32(e.committeeColdKeyAddress).getProps().paymentPart;if(!t||!r)throw Error("Malformed hot/cold credential");return t4.newAuthCommitteeHotCert(new eZ.v(r,t))}case"CommitteeColdResign":{let t;let r=P.kL.fromBech32(e.committeeColdKeyAddress).getProps().paymentPart;if(!r)throw Error("Malformed hot/cold credential");return e.anchor&&(t=new e$.e(e.anchor.anchorUrl,t2(e.anchor.anchorDataHash))),t4.newResignCommitteeColdCert(new eG.G(r,t))}case"DRepRegistration":{let t;e.anchor&&(t=new e$.e(e.anchor.anchorUrl,t2(e.anchor.anchorDataHash)));let r=r$(e.drepId).toCore();if(eE.ar(r))return t4.newRegisterDelegateRepresentativeCert(new eJ.S(r,BigInt(e.coin),t));throw Error("DRepId must be a Credential")}case"DRepDeregistration":{let t=r$(e.drepId).toCore();if(eE.ar(t))return t4.newUnregisterDelegateRepresentativeCert(new eY.h(t,BigInt(e.coin)));throw Error("DRepId must be a Credential")}case"DRepUpdate":{let t;e.anchor&&(t=new e$.e(e.anchor.anchorUrl,t2(e.anchor.anchorDataHash)));let r=r$(e.drepId).toCore();if(eE.ar(r))return t4.newUpdateDelegateRepresentativeCert(new eX.l(r,t));throw Error("DRepId must be a Credential")}}},ii=e=>{let t=new Map;return e.forEach((e,r)=>{t.set(r,io(e))}),t},io=e=>{if("number"==typeof e)return tN.newInteger(BigInt(e));if("string"==typeof e)return tN.newText(e);if("bigint"==typeof e)return tN.newInteger(e);if(e instanceof Uint8Array)return tN.newBytes(e);if(e instanceof Map){let t=new tH;return e.forEach((e,r)=>{t.insert(io(r),io(e))}),tN.newMap(t)}if(Array.isArray(e)){let t=new tR;return e.forEach(e=>{t.add(io(e))}),tN.newList(t)}throw Error("metadatumToObj: Unsupported Metadatum type")},is=new Uint8Array([160]),ia=(e,t,r)=>{let i=new Z.M;if(r&&r.size()>0&&(!t||0===t.size()))i.writeEncodedValue(is),i.writeEncodedValue(e4.from(r.toCbor(),"hex")),i.writeEncodedValue(is);else{if(!t||0===t.size())return;i.writeEncodedValue(e4.from(t.toCbor(),"hex")),r&&r.size()>0&&i.writeEncodedValue(e4.from(r.toCbor(),"hex")),i.writeEncodedValue(e4.from(e.languageViewsEncoding(),"hex"))}return ea.yx.fromHexBlob(em.sZ.fromBytes(ef(ef.BYTES).update(i.encode()).digest()))},iu=e=>{switch(e.type){case"ConstitutionalCommittee":switch(e.hotCred.type){case"KeyHash":return eQ.a.newConstitutionalCommitteeHotKey({type:0,hash:t1(e.hotCred.keyHash)});case"ScriptHash":return eQ.a.newConstitutionalCommitteeHotKey({type:1,hash:t1(e.hotCred.scriptHash)})}case"DRep":{let t=r$(e.drepId);if(void 0!==t.toKeyHash())return eQ.a.newDrep({type:0,hash:t1(t.toKeyHash())});if(void 0!==t.toScriptHash())return eQ.a.newDrep({type:1,hash:t1(t.toScriptHash())});throw Error("Invalid DRep provided")}case"StakingPool":return eQ.a.newStakingPool(t0(e.keyHash))}},ic=e=>new e0.d(ih(e.voteKind),e.anchor?il(e.anchor):void 0),il=e=>new e$.e(e.anchorUrl,t2(e.anchorDataHash)),ih=e=>{switch(e){case"Yes":return 1;case"No":return 0;case"Abstain":return 2}},id=e=>new e1.k(u.az(e.txHash),BigInt(e.txIndex)),ip=class{protocolParams;constructor(e){(0,eV.C)(!0),this.protocolParams=e||eg.FW}serializeRewardAddress(e,t,r){return t$.fromCredentials(r??0,{type:t?t3.ScriptHash:t3.KeyHash,hash:t1(e)}).toAddress().toBech32()}serializePoolId(e){return t5.fromKeyHash(t0(e)).toString()}serializeAddress(e,t){let r,i;e.pubKeyHash&&""!==e.pubKeyHash?i={type:t3.KeyHash,hash:t1(e.pubKeyHash)}:e.scriptHash&&""!==e.scriptHash&&(i={type:t3.ScriptHash,hash:t1(e.scriptHash)}),e.stakeCredentialHash&&""!==e.stakeCredentialHash?r={type:t3.KeyHash,hash:t1(e.stakeCredentialHash)}:e.stakeScriptCredentialHash&&(r={type:t3.ScriptHash,hash:t1(e.stakeScriptCredentialHash)});let o=tG.BasePaymentKeyStakeKey;return i&&r?i.type===t3.KeyHash&&r.type===t3.KeyHash?o=tG.BasePaymentKeyStakeKey:i.type===t3.KeyHash&&r.type===t3.ScriptHash?o=tG.BasePaymentKeyStakeScript:i.type===t3.ScriptHash&&r.type===t3.KeyHash?o=tG.BasePaymentScriptStakeKey:i.type===t3.ScriptHash&&r.type===t3.ScriptHash&&(o=tG.BasePaymentScriptStakeScript):i?i.type===t3.KeyHash?o=tG.EnterpriseKey:i.type===t3.ScriptHash&&(o=tG.EnterpriseScript):r&&(r.type===t3.KeyHash?o=tG.RewardKey:r.type===t3.ScriptHash&&(o=tG.RewardScript)),new tZ({type:o,networkId:t??0,paymentPart:i,delegationPart:r}).toBech32()}serializeData(e){return rO(e).toCbor().toString()}deserializer={key:{deserializeAddress:function(e){let t=tZ.fromBech32(e).getProps();return{pubKeyHash:t.paymentPart?.type===t3.KeyHash?t.paymentPart?.hash??"":"",scriptHash:t.paymentPart?.type===t3.ScriptHash?t.paymentPart?.hash??"":"",stakeCredentialHash:t.delegationPart?.type===t3.KeyHash?t.paymentPart?.hash??"":"",stakeScriptCredentialHash:t.delegationPart?.type===t3.ScriptHash?t.paymentPart?.hash??"":""}}},script:{deserializeNativeScript:function(e){let t=rF(e);return{scriptHash:t.hash().toString(),scriptCbor:t.toCbor().toString()}},deserializePlutusScript:function(e){let t;switch(e.version){case"V1":t=new ro((0,em.sZ)(e.code));break;case"V2":t=new rn((0,em.sZ)(e.code));break;case"V3":t=new rs((0,em.sZ)(e.code))}return{scriptHash:t.hash().toString(),scriptCbor:t.toCbor().toString()}}},cert:{deserializePoolId:function(e){let t=t5(e);return t5.toKeyHash(t).toString()}}};resolver={keys:{resolveStakeKeyHash:function(e){let t=rK(e);return t.asReward()?.getPaymentCredential().type===t3.KeyHash?t.asReward().getPaymentCredential().hash:""},resolvePrivateKey:function(e){let t=((e,t="")=>re.fromBip39Entropy(ey.Buffer.from((0,eg.O0)(e)),(0,eg.W_)(t)))((0,eg.oy)(e.join(" "))),r=eS.encode(t.bytes());return ex.bech32.encode("xprv",r,1023)},resolveRewardAddress:function(e){let t=rK(e),r=t.getProps();return r.delegationPart?t$.fromCredentials(t.getNetworkId(),r.delegationPart).toAddress().toBech32()??"":""},resolveEd25519KeyHash:function(e){let t=rK(e).getProps();return t.paymentPart?t.paymentPart.hash.toString():""}},tx:{resolveTxHash:function(e){return tP.fromCbor(a.K$(e)).getId()}},data:{resolveDataHash:function(e,t="Mesh"){return ie(e,t)}},script:{resolveScriptRef:function(e){if("code"in e){let t;switch(e.version){case"V1":t=1;break;case"V2":t=2;break;case"V3":t=3}let r=new ew.CborTag(24,ew.Cbor.parse(ew.CborString.fromCborObj(new ew.CborBytes(ew.Cbor.encode(new ew.CborArray([new ew.CborUInt(t),new ew.CborString(e.code).toCborObj()])).toBuffer()))));return ew.Cbor.encode(r).toString()}{let t=rF(e),r=new ew.CborTag(24,ew.Cbor.parse(ew.CborString.fromCborObj(new ew.CborBytes(ew.Cbor.encode(new ew.CborArray([new ew.CborUInt(0),new ew.CborString(t.toCbor()).toCborObj()])).toBuffer()))));return ew.Cbor.encode(r).toString()}}}};serializeTxBody=(e,t)=>new im(t??this.protocolParams).coreSerializeTx(e);serializeTxBodyWithMockSignatures(e,t){return new im(t).coreSerializeTxWithMockSignatures(e)}addSigningKeys=(e,t)=>{let r=tP.fromCbor(a.K$(e)),i=r.witnessSet(),o=i.vkeys(),n=o?[...o.values()]:[];for(let e=0;e<t.length;e++){let i=t[e];if(i){68===i.length&&"5820"===i.substring(0,4)&&(i=i.substring(4));let e=rN(i),t=e.sign((0,em.sZ)(r.getId()));n.push(new t9(tX(e.toPublic().hex()),t6(t.hex())))}}return i.setVkeys(ee.A.fromCore(n.map(e=>e.toCore()),t9.fromCore)),r.setWitnessSet(i),r.toCbor()};serializeValue(e){return rZ(e).toCbor()}serializeOutput(e){let t=new tO(rU(e.address),rZ(e.amount));if(e.datum?.type==="Hash"?t.setDatum(rh.newDataHash(rO(e.datum.data).hash())):e.datum?.type==="Inline"?t.setDatum(rh.newInlineData(rO(e.datum.data))):e.datum?.type==="Embedded"&&t.setDatum(rh.newDataHash(rO(e.datum.data).hash())),e.referenceScript)switch(e.referenceScript.version){case"V1":t.setScriptRef(tW.newPlutusV1Script(ro.fromCbor((0,em.sZ)(e.referenceScript.code))));break;case"V2":t.setScriptRef(tW.newPlutusV2Script(rn.fromCbor((0,em.sZ)(e.referenceScript.code))));break;case"V3":t.setScriptRef(tW.newPlutusV3Script(rs.fromCbor((0,em.sZ)(e.referenceScript.code))));break;default:t.setScriptRef(tW.newNativeScript(ri.fromCbor((0,em.sZ)(e.referenceScript.code))))}return t.toCbor()}parser={getRequiredInputs:function(e){throw Error("Function not implemented.")},parse:function(e,t){throw Error("Method not implemented.")},toTester:function(){throw Error("Method not implemented.")},getBuilderBody:function(){throw Error("Method not implemented.")},getBuilderBodyWithoutChange:function(){throw Error("Method not implemented.")}}},im=class{txBody;txWitnessSet;txAuxilliaryData;utxoContext=new Map;mintRedeemers=new Map;scriptsProvided=new Set;datumsProvided=new Set;usedLanguages={0:!1,1:!1,2:!1};protocolParams;refScriptSize;constructor(e){this.protocolParams=e||eg.FW,this.txBody=new tE(ee.A.fromCore([],tT.fromCore),[],BigInt(0),void 0),this.refScriptSize=0,this.txWitnessSet=new tk,this.txAuxilliaryData=new tV}coreSerializeTxBody=e=>{let{inputs:t,outputs:r,collaterals:i,requiredSignatures:o,referenceInputs:n,mints:s,metadata:a,scriptMetadata:u,validityRange:c,certificates:l,withdrawals:h,votes:d,proposals:p,totalCollateral:f,collateralReturnAddress:m,changeAddress:g}=e,y=this.removeBodyInputRefInputOverlap(t,n);try{this.addAllInputs(t)}catch(e){ig("Error serializing inputs",e)}try{this.setFee(e.fee??"0")}catch(e){ig("Error serializing fee",e)}try{this.sanitizeOutputs(r)}catch(e){ig("Error calculating min utxo values for outputs",e)}try{this.addAllOutputs(r)}catch(e){ig("Error serializing outputs",e)}try{this.addAllMints(s)}catch(e){ig("Error serializing mints",e)}try{this.addAllCerts(l)}catch(e){ig("Error serializing certificates",e)}try{this.addAllWithdrawals(h)}catch(e){ig("Error serializing withdrawals",e)}try{this.addAllVotes(d)}catch(e){ig("Error serializing votes",e)}try{this.addAllProposals(p)}catch(e){ig("Error serializing proposals",e)}try{this.addAllCollateralInputs(i)}catch(e){ig("Error serializing collateral inputs",e)}if(f)try{this.txBody.setTotalCollateral(BigInt(f)),this.addCollateralReturn(f,i,m??g)}catch(e){ig("Error serializing total collateral and collateral return",e)}try{this.addAllReferenceInputs(y)}catch(e){ig("Error serializing reference inputs",e)}this.removeInputRefInputOverlap();try{this.setValidityInterval(c)}catch(e){ig("Error serializing validity interval",e)}try{this.addAllRequiredSignatures(o)}catch(e){ig("Error serializing required signatures",e)}if(a.size>0)try{this.addMetadata(a)}catch(e){ig("Error serializing metadata",e)}try{this.addScriptMetadata(u)}catch(e){ig("Error serializing script metadata",e)}return this.txBody};coreSerializeTx(e){let t=this.coreSerializeTxBody(e);return void 0!==e.fee&&this.txBody.setFee(BigInt(e.fee)),this.buildWitnessSet(),new tP(t,this.txWitnessSet,this.txAuxilliaryData).toCbor()}coreSerializeTxWithMockSignatures(e){return new tP(this.coreSerializeTxBody(e),this.createMockedWitnessSet(e.expectedNumberKeyWitnesses,e.expectedByronAddressWitnesses),this.txAuxilliaryData).toCbor()}sanitizeOutputs=e=>{for(let t=0;t<e.length;t++){let r=e[t],i=!1;for(let e=0;e<r.amount.length;e++){let t=r.amount[e];if((t?.unit==""||t?.unit=="lovelace")&&(i=!0,t?.quantity=="0"||t?.quantity=="")){t.unit="lovelace",t.quantity="10000000";let e=(160+this.toCardanoOutput(r).toCbor().length/2+1)*this.protocolParams.coinsPerUtxoSize;t.quantity=e.toString()}}if(!i){let e={unit:"lovelace",quantity:"10000000"};r.amount.push(e);let t=(160+this.toCardanoOutput(r).toCbor().length/2+1)*this.protocolParams.coinsPerUtxoSize;if(e.quantity=t.toString(),!i){let e={unit:"lovelace",quantity:"10000000"};r.amount.push(e);let t=(160+this.toCardanoOutput(r).toCbor().length/2+1)*this.protocolParams.coinsPerUtxoSize;e.quantity=t.toString()}}}};addAllInputs=e=>{for(let t=0;t<e.length;t+=1){let r=e[t];if(r)switch(r.type){case"PubKey":this.addTxIn(r);break;case"Script":this.addScriptTxIn(r,t);break;case"SimpleScript":this.addSimpleScriptTxIn(r)}}};addTxIn=e=>{let t=new tT(tB(e.txIn.txHash),BigInt(e.txIn.txIndex)),r=this.txBody.inputs(),i=[...r.values()];if(i.find(e=>{e.index()==t.index()&&(e.transactionId,t.transactionId)}))throw Error("Duplicate input added to tx body");i.push(t),r.setValues(i);let o=new tO(rU(e.txIn.address),rZ(e.txIn.amount));this.utxoContext.set(t,o),this.txBody.setInputs(r),e.txIn.scriptSize&&(this.refScriptSize+=e.txIn.scriptSize)};addScriptTxIn=(e,t)=>{if(this.addTxIn({type:"PubKey",txIn:e.txIn}),!e.scriptTxIn.scriptSource)throw Error("A script input had no script source");if(!e.scriptTxIn.datumSource)throw Error("A script input had no datum source");if(!e.scriptTxIn.redeemer)throw Error("A script input had no redeemer");"Provided"===e.scriptTxIn.scriptSource.type?this.addProvidedPlutusScript(e.scriptTxIn.scriptSource.script):"Inline"===e.scriptTxIn.scriptSource.type&&this.addScriptRef(e.scriptTxIn.scriptSource),"Provided"===e.scriptTxIn.datumSource.type?this.datumsProvided.add(rO(e.scriptTxIn.datumSource.data)):"Inline"===e.scriptTxIn.datumSource.type&&this.addReferenceInput({txHash:e.txIn.txHash,txIndex:e.txIn.txIndex});let r=e.scriptTxIn.redeemer.exUnits,i=this.txWitnessSet.redeemers()??tj.fromCore([]),o=[...i.values()];o.push(new tK(tU.Spend,BigInt(t),rO(e.scriptTxIn.redeemer.data),new rd(BigInt(r.mem),BigInt(r.steps)))),i.setValues(o),this.txWitnessSet.setRedeemers(i)};addSimpleScriptTxIn=e=>{if(this.addTxIn({type:"PubKey",txIn:e.txIn}),!e.simpleScriptTxIn.scriptSource)throw Error("A native script input had no script source");"Provided"===e.simpleScriptTxIn.scriptSource.type?this.scriptsProvided.add(tW.newNativeScript(ri.fromCbor((0,em.sZ)(e.simpleScriptTxIn.scriptSource.scriptCode))).toCbor()):"Inline"===e.simpleScriptTxIn.scriptSource.type&&this.addSimpleScriptRef(e.simpleScriptTxIn.scriptSource)};addAllOutputs=e=>{for(let t=0;t<e.length;t++)this.addOutput(e[t])};addOutput=e=>{let t=this.txBody.outputs();t.push(this.toCardanoOutput(e)),this.txBody.setOutputs(t)};toCardanoOutput=e=>{let t=new tO(rU(e.address),rZ(e.amount));if(e.datum?.type==="Hash")t.setDatum(rh.newDataHash(rl(rO(e.datum.data).hash())));else if(e.datum?.type==="Inline")t.setDatum(rh.newInlineData(rO(e.datum.data)));else if(e.datum?.type==="Embedded"){t.setDatum(rh.newDataHash(rl(rO(e.datum.data).hash())));let r=this.txWitnessSet.plutusData()??ee.A.fromCore([],w.$.fromCore),i=[...r.values()];i.push(rO(e.datum.data)),r.setValues(i),this.txWitnessSet.setPlutusData(r)}if(e.referenceScript)switch(e.referenceScript.version){case"V1":t.setScriptRef(tW.newPlutusV1Script(ro.fromCbor((0,em.sZ)(e.referenceScript.code))));break;case"V2":t.setScriptRef(tW.newPlutusV2Script(rn.fromCbor((0,em.sZ)(e.referenceScript.code))));break;case"V3":t.setScriptRef(tW.newPlutusV3Script(rs.fromCbor((0,em.sZ)(e.referenceScript.code))))}return t};addAllReferenceInputs=e=>{for(let t=0;t<e.length;t++)this.addReferenceInput(e[t])};addReferenceInput=e=>{let t=this.txBody.referenceInputs()??ee.A.fromCore([],tT.fromCore),r=[...t.values()];r.some(t=>t.transactionId().toString()===e.txHash&&t.index().toString()===e.txIndex.toString())||(r.push(new tT(tB(e.txHash),BigInt(e.txIndex))),t.setValues(r),e.scriptSize&&(this.refScriptSize+=e.scriptSize),this.txBody.setReferenceInputs(t))};addAllMints=e=>{for(let t=0;t<e.length;t++)this.addMint(e[t]);let t=this.txWitnessSet.redeemers()??tj.fromCore([]),r=[...t.values()],i=0;this.mintRedeemers.forEach(e=>{let o=new tK(e.tag(),BigInt(i),e.data(),e.exUnits());r.push(o),t.setValues(r),i++}),this.txWitnessSet.setRedeemers(t)};addMint=e=>{let t=this.txBody.mint()??new Map;for(let r of e.mintValue){let i=`${e.policyId}${r.assetName}`;for(let e of t.keys())if(e.toString()==i)throw Error("The same asset is already in the mint field");t.set(tF.fromParts(tL(e.policyId),tq(r.assetName)),BigInt(r.amount))}if(this.txBody.setMint(t),"Native"===e.type){if(!e.scriptSource)throw Error("Script source not provided for native script mint");let t=e.scriptSource;if(!t)throw Error("A script source for a native script was not a native script somehow");"Provided"===t.type?this.scriptsProvided.add(tW.newNativeScript(ri.fromCbor((0,em.sZ)(t.scriptCode))).toCbor()):"Inline"===t.type&&this.addSimpleScriptRef(t)}else if("Plutus"===e.type){if(!e.scriptSource)throw Error("Script source not provided for plutus script mint");let t=e.scriptSource;if(!t)throw Error("A script source for a plutus mint was not plutus script somehow");if(!e.redeemer)throw Error("A redeemer was not provided for a plutus mint");let r=new tK(tU.Mint,BigInt(0),rO(e.redeemer.data),new rd(BigInt(e.redeemer.exUnits.mem),BigInt(e.redeemer.exUnits.steps)));if(this.mintRedeemers.has(e.policyId)){if(this.mintRedeemers.get(e.policyId)?.toCbor()!==r.toCbor())throw Error("The same minting policy must have the same redeemer")}else this.mintRedeemers.set(e.policyId,r);"Provided"===t.type?this.addProvidedPlutusScript(t.script):"Inline"===t.type&&this.addScriptRef(t)}};addAllCerts=e=>{for(let t=0;t<e.length;t++)this.addCert(e[t],t)};addCert=(e,t)=>{let r=this.txBody.certs()??ee.A.fromCore([],H.K.fromCore),i=[...r.values()];if(i.push(ir(e.certType)),r.setValues(i),this.txBody.setCerts(r),"SimpleScriptCertificate"===e.type){if(!e.simpleScriptSource)throw Error("Script source not provided for native script cert");let t=e.simpleScriptSource;if(!t)throw Error("A script source for a native script was not a native script somehow");"Provided"===t.type?this.scriptsProvided.add(tW.newNativeScript(ri.fromCbor((0,em.sZ)(t.scriptCode))).toCbor()):"Inline"===t.type&&this.addSimpleScriptRef(t)}else if("ScriptCertificate"===e.type){if(!e.scriptSource)throw Error("Script source not provided for plutus script certificate");let r=e.scriptSource;if(!r)throw Error("A script source for a plutus certificate was not plutus script somehow");if(!e.redeemer)throw Error("A redeemer was not provided for a plutus certificate");let i=this.txWitnessSet.redeemers()??tj.fromCore([]),o=[...i.values()];o.push(new tK(tU.Cert,BigInt(t),rO(e.redeemer.data),new rd(BigInt(e.redeemer.exUnits.mem),BigInt(e.redeemer.exUnits.steps)))),i.setValues(o),this.txWitnessSet.setRedeemers(i),"Provided"===r.type?this.addProvidedPlutusScript(r.script):"Inline"===r.type&&this.addScriptRef(r)}};addAllWithdrawals=e=>{for(let t=0;t<e.length;t++)this.addWithdrawal(e[t],t)};addWithdrawal=(e,t)=>{let r=this.txBody.withdrawals()??new Map,i=rU(e.address),o=i.asReward();if(!o)throw Error("Failed to parse reward address for withdrawal");if(r.set(rc.fromCredential(o.getPaymentCredential(),i.getNetworkId()),BigInt(e.coin)),this.txBody.setWithdrawals(r),"SimpleScriptWithdrawal"===e.type){if(!e.scriptSource)throw Error("Script source not provided for native script cert");let t=e.scriptSource;if(!t)throw Error("A script source for a native script was not a native script somehow");"Provided"===t.type?this.scriptsProvided.add(tW.newNativeScript(ri.fromCbor((0,em.sZ)(t.scriptCode))).toCbor()):"Inline"===t.type&&this.addSimpleScriptRef(t)}else if("ScriptWithdrawal"===e.type){if(!e.scriptSource)throw Error("Script source not provided for plutus script certificate");let r=e.scriptSource;if(!r)throw Error("A script source for a plutus certificate was not plutus script somehow");if(!e.redeemer)throw Error("A redeemer was not provided for a plutus certificate");let i=this.txWitnessSet.redeemers()??tj.fromCore([]),o=[...i.values()];o.push(new tK(tU.Reward,BigInt(t),rO(e.redeemer.data),new rd(BigInt(e.redeemer.exUnits.mem),BigInt(e.redeemer.exUnits.steps)))),i.setValues(o),this.txWitnessSet.setRedeemers(i),"Provided"===r.type?this.addProvidedPlutusScript(r.script):"Inline"===r.type&&this.addScriptRef(r)}};addAllCollateralInputs=e=>{for(let t=0;t<e.length;t++)this.addCollateralInput(e[t])};addCollateralInput=e=>{let t=new tT(tB(e.txIn.txHash),BigInt(e.txIn.txIndex)),r=this.txBody.collateral()??ee.A.fromCore([],tT.fromCore),i=[...r.values()];if(i.find(e=>{e.index()==t.index()&&(e.transactionId,t.transactionId)}))throw Error("Duplicate input added to tx body");i.push(t),r.setValues(i);let o=new tO(rU(e.txIn.address),rZ(e.txIn.amount));this.utxoContext.set(t,o),this.txBody.setCollateral(r)};addCollateralReturn=(e,t,r)=>{let i=tA.fromCore({coins:-BigInt(e)});for(let e of t)i=function(e,t){let r=e.multiasset()??new Map;return t.multiasset()?.forEach((e,t)=>{let i=(r.get(t)??0n)+e;0n==i?r.delete(t):r.set(t,i)}),new tA(BigInt(e.coin())+BigInt(t.coin()),r.size>0?r:void 0)}(i,rZ(e.txIn.amount));let o=new tO(rU(r),i);this.txBody.setCollateralReturn(o)};setValidityInterval=e=>{e.invalidBefore&&this.txBody.setValidityStartInterval(tI(e.invalidBefore)),e.invalidHereafter&&this.txBody.setTtl(tI(e.invalidHereafter))};setFee=e=>{this.txBody.setFee(BigInt(e))};addAllRequiredSignatures=e=>{let t=this.txBody.requiredSigners()??ee.A.fromCore([],J.k.fromCore),r=[...t.values()];for(let t of e)r.push(J.k.fromCore(t0(t)));t.setValues(r),this.txBody.setRequiredSigners(t)};addMetadata=e=>{this.txAuxilliaryData.setMetadata(new eN.y(ii(e)))};addScriptMetadata=e=>{let t=[],r=[],i=[],o=[];for(let n of e)switch(n.scriptType){case"Native":t.push(ri.fromCbor((0,em.sZ)(n.scriptCbor)));break;case"PlutusV1":r.push(ro.fromCbor((0,em.sZ)(n.scriptCbor)));break;case"PlutusV2":i.push(rn.fromCbor((0,em.sZ)(n.scriptCbor)));break;case"PlutusV3":o.push(rs.fromCbor((0,em.sZ)(n.scriptCbor)))}this.txAuxilliaryData.setNativeScripts(t),this.txAuxilliaryData.setPlutusV1Scripts(r),this.txAuxilliaryData.setPlutusV2Scripts(i),this.txAuxilliaryData.setPlutusV3Scripts(o)};createMockedWitnessSet=(e,t)=>{this.buildWitnessSet();let r=tk.fromCbor(this.txWitnessSet.toCbor()),i=this.mockBootstrapWitnesses(t),o=this.mockVkeyWitnesses(e),n=rf.fromCore([],rv.fromCore);n.setValues(i),r.setBootstraps(n);let s=rf.fromCore([],t9.fromCore);return s.setValues(o),r.setVkeys(s),r};buildWitnessSet=()=>{let e=this.txWitnessSet.nativeScripts()??ee.A.fromCore([],ri.fromCore),t=this.txWitnessSet.plutusV1Scripts()??ee.A.fromCore([],ro.fromCore),r=this.txWitnessSet.plutusV2Scripts()??ee.A.fromCore([],rn.fromCore),i=this.txWitnessSet.plutusV3Scripts()??ee.A.fromCore([],rs.fromCore);this.scriptsProvided.forEach(o=>{let n=tW.fromCbor((0,em.sZ)(o));if(void 0!==n.asNative()){let t=[...e.values()];t.push(n.asNative()),e.setValues(t)}else if(void 0!==n.asPlutusV1()){let e=[...t.values()];e.push(n.asPlutusV1()),t.setValues(e)}else if(void 0!==n.asPlutusV2()){let e=[...r.values()];e.push(n.asPlutusV2()),r.setValues(e)}else if(void 0!==n.asPlutusV3()){let e=[...i.values()];e.push(n.asPlutusV3()),i.setValues(e)}this.txWitnessSet.setNativeScripts(e),this.txWitnessSet.setPlutusV1Scripts(t),this.txWitnessSet.setPlutusV2Scripts(r),this.txWitnessSet.setPlutusV3Scripts(i)});let o=this.txWitnessSet.plutusData()??ee.A.fromCore([],tz.fromCore),n=[...o.values()];this.datumsProvided.forEach(e=>{n.push(e)}),o.setValues(n),this.txWitnessSet.setPlutusData(o);let s=F.a.newPlutusV1(eg.sk),a=F.a.newPlutusV2(eg.Hw),u=F.a.newPlutusV3(eg.ar),c=new q.o;this.usedLanguages[rr.V1]&&c.insert(s),this.usedLanguages[rr.V2]&&c.insert(a),this.usedLanguages[rr.V3]&&c.insert(u);let l=ia(c,this.txWitnessSet.redeemers()??tj.fromCore([]),o.size()>0?o:void 0);l&&this.txBody.setScriptDataHash(l);let h=rw(this.txAuxilliaryData.toCore());h&&this.txBody.setAuxiliaryDataHash(h)};removeInputRefInputOverlap=()=>{let e=[],t=this.txBody.inputs()?.values();this.txBody.referenceInputs()&&(this.txBody.referenceInputs().values().forEach(r=>{let i=!1;for(let e=0;e<t.length;e++)r.toCbor()===t[e].toCbor()&&(i=!0);i||e.push(r)}),this.txBody.setReferenceInputs(ee.A.fromCore(e.map(e=>e.toCore()),tT.fromCore)))};removeBodyInputRefInputOverlap=(e,t)=>{let r=[];for(let i=0;i<t.length;i++){let o=t[i];e.some(e=>e.txIn.txHash===o.txHash&&e.txIn.txIndex===o.txIndex)||r.push(o)}return r};addScriptRef=e=>{if("Inline"===e.type){if(!e.scriptSize)throw Error("A reference script was used without providing its size, this must be provided as fee calculations are based on it");switch(this.addReferenceInput({txHash:e.txHash,txIndex:e.txIndex,scriptSize:Number(e.scriptSize)}),e.version){case"V1":this.usedLanguages[rr.V1]=!0;break;case"V2":this.usedLanguages[rr.V2]=!0;break;case"V3":this.usedLanguages[rr.V3]=!0}}};addSimpleScriptRef=e=>{if("Inline"===e.type){if(!e.scriptSize)throw Error("A reference script was used without providing its size, this must be provided as fee calculations are based on it");this.addReferenceInput({txHash:e.txHash,txIndex:e.txIndex,scriptSize:Number(e.scriptSize)})}};addProvidedPlutusScript=e=>{switch(e.version){case"V1":this.scriptsProvided.add(tW.newPlutusV1Script(ro.fromCbor((0,em.sZ)(e.code))).toCbor()),this.usedLanguages[rr.V1]=!0;break;case"V2":this.scriptsProvided.add(tW.newPlutusV2Script(rn.fromCbor((0,em.sZ)(e.code))).toCbor()),this.usedLanguages[rr.V2]=!0;break;case"V3":this.scriptsProvided.add(tW.newPlutusV3Script(rs.fromCbor((0,em.sZ)(e.code))).toCbor()),this.usedLanguages[rr.V3]=!0}};addAllVotes=e=>{for(let t=0;t<e.length;t++){let r=e[t];switch(r.type){case"BasicVote":this.addBasicVote(r);break;case"ScriptVote":this.addScriptVote(r,t);break;case"SimpleScriptVote":this.addSimpleScriptVote(r)}}};addBasicVote=e=>{let t=this.txBody.votingProcedures()??eH.U.fromCore([]);t.insert(iu(e.vote.voter),id(e.vote.govActionId),ic(e.vote.votingProcedure)),this.txBody.setVotingProcedures(t)};addScriptVote=(e,t)=>{if(!e.scriptSource)throw Error("Script source not provided for plutus script vote");let r=e.scriptSource;if(!r)throw Error("A script source for a plutus certificate was not plutus script somehow");if(!e.redeemer)throw Error("A redeemer was not provided for a plutus vote");let i=this.txWitnessSet.redeemers()??tj.fromCore([]),o=[...i.values()];o.push(new tK(tU.Voting,BigInt(t),rO(e.redeemer.data),new rd(BigInt(e.redeemer.exUnits.mem),BigInt(e.redeemer.exUnits.steps)))),i.setValues(o),this.txWitnessSet.setRedeemers(i),"Provided"===r.type?this.addProvidedPlutusScript(r.script):"Inline"===r.type&&this.addScriptRef(r),this.addBasicVote({type:"BasicVote",vote:e.vote})};addSimpleScriptVote=e=>{if(!e.simpleScriptSource)throw Error("Script source not provided for native script vote");let t=e.simpleScriptSource;if(!t)throw Error("A script source for a native script was not a native script somehow");"Provided"===t.type?this.scriptsProvided.add(tW.newNativeScript(ri.fromCbor((0,em.sZ)(t.scriptCode))).toCbor()):"Inline"===t.type&&this.addSimpleScriptRef(t),this.addBasicVote({type:"BasicVote",vote:e.vote})};addAllProposals=e=>{for(let t=0;t<e.length;t++){let r=e[t];if(r)switch(r.type){case"BasicProposal":this.addBasicProposal(r);break;case"ScriptProposal":this.addScriptProposal(r,t);break;case"SimpleScriptProposal":this.addSimpleScriptProposal(r)}}};addBasicProposal=e=>{let t=this.txBody.proposalProcedures(),r=t?[...t.values()]:[],i=r8(e.proposalType.governanceAction,e.proposalType.anchor,e.proposalType.rewardAccount,BigInt(e.proposalType.deposit));r.push(i),this.txBody.setProposalProcedures(rf.fromCore(r.map(e=>e.toCore()),ek.I.fromCore))};addScriptProposal=(e,t)=>{if("ScriptProposal"!==e.type)throw Error("Expected ScriptProposal");if(!e.scriptSource)throw Error("Script source not provided for plutus script proposal");let r=e.scriptSource;if(!r)throw Error("A script source for a plutus proposal was not plutus script somehow");if(!e.redeemer)throw Error("A redeemer was not provided for a plutus proposal");let i=this.txWitnessSet.redeemers()??tj.fromCore([]),o=[...i.values()];o.push(new tK(tU.Proposing,BigInt(t),rO(e.redeemer.data),new rd(BigInt(e.redeemer.exUnits.mem),BigInt(e.redeemer.exUnits.steps)))),i.setValues(o),this.txWitnessSet.setRedeemers(i),"Provided"===r.type?this.addProvidedPlutusScript(r.script):"Inline"===r.type&&this.addScriptRef(r),this.addBasicProposal(e)};addSimpleScriptProposal=e=>{if("SimpleScriptProposal"!==e.type)throw Error("Expected SimpleScriptProposal");if(!e.simpleScriptSource)throw Error("Script source not provided for native script proposal");let t=e.simpleScriptSource;if(!t)throw Error("A script source for a native script was not a native script somehow");"Provided"===t.type?this.scriptsProvided.add(tW.newNativeScript(ri.fromCbor((0,em.sZ)(t.scriptCode))).toCbor()):"Inline"===t.type&&this.addSimpleScriptRef(t),this.addBasicProposal(e)};mockVkeyWitnesses=e=>{let t=[];for(let r=0;r<e;r++){let e=this.numberToIntegerHex(r),i=this.mockPubkey(e),o=this.mockSignature(e);t.push(new t9(tX(i),t6(o)))}return t};mockPubkey(e){return"0".repeat(64-e.length).concat(e)}mockSignature(e){return"0".repeat(128-e.length).concat(e)}mockChainCode=e=>"0".repeat(64-e.length).concat(e);numberToIntegerHex=e=>BigInt(e).toString(16);mockBootstrapWitnesses=e=>{let t=[];for(let r=0;r<e.length;r++){let i=tZ.fromBytes(e[r]).asByron();if(!i)throw Error(`Failed to parse byron address: ${e[r]}`);let o=this.numberToIntegerHex(r),n=this.mockPubkey(o),s=this.mockSignature(o),a=this.mockChainCode(o),u=i.getAttributes();t.push(new rv(tX(n),t6(s),(0,em.sZ)(a),this.serializeByronAttributes(u)))}return t};serializeByronAttributes=e=>{let t=new ra,r=0;if(e.magic&&r++,e.derivationPath&&r++,t.writeStartMap(r),e.derivationPath){t.writeInt(1);let r=new ra().writeByteString(ey.Buffer.from(e.derivationPath,"hex")).encode();t.writeByteString(r)}if(e.magic){t.writeInt(2);let r=new ra().writeInt(e.magic).encode();t.writeByteString(r)}return t.encodeAsHex()}},ig=(e,t)=>{if(t instanceof Error)throw Error(`${e}: ${t.message}`);if("string"==typeof t)throw Error(`${e}: ${t}`);if("object"==typeof t)throw Error(`${e}: ${JSON.stringify(t)}`);throw Error(`${e}: ${String(t)}`)}}}]);